import{r,A as K,_ as U,C as se,c as k,a as ge,L as je,t as ye,g as be,m as Ne,b as Ce,u as w,d as T,n as J,j as t,e as ke,f as Se,i as E,P as ne,M as F,R as ie,S as $e,h as D,k as oe,s as P,F as Ie,l as re,I as z,B as S,o as Q,p as le,q as I,v as Y,w as _e,x as Oe,O as we,y as O,z as Pe,D as L,E as De,G as X,H as Ee,T as Me,J as Te,N as _,K as M,Q as ce,U as R,V as Ae,W as Be,X as ze,Y as Le,Z as Re,$ as V,a0 as qe,a1 as He,a2 as Fe,a3 as Ve,a4 as We,a5 as Ke,a6 as Ue,a7 as Je,a8 as Xe,a9 as H,aa as de,ab as Ge,ac as Qe,ad as W,ae as Z,af as Ye,ag as Ze,ah as et,ai as tt,aj as at}from"./index-0b453699.js";var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 680h-54V540H546v-92h238c8.8 0 16-7.2 16-16V168c0-8.8-7.2-16-16-16H240c-8.8 0-16 7.2-16 16v264c0 8.8 7.2 16 16 16h238v92H190v140h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8zM256 805.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zm288 0c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM288 384V216h448v168H288zm544 421.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM360 300a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"cluster",theme:"outlined"};const nt=st;var it=function(a,i){return r.createElement(K,U({},a,{ref:i,icon:nt}))},ot=r.forwardRef(it);const ee=ot;var rt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"};const lt=rt;var ct=function(a,i){return r.createElement(K,U({},a,{ref:i,icon:lt}))},dt=r.forwardRef(ct);const mt=dt;var pt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};const ut=pt;var ht=function(a,i){return r.createElement(K,U({},a,{ref:i,icon:ut}))},ft=r.forwardRef(ht);const xt=ft;var vt=globalThis&&globalThis.__rest||function(e,a){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]]);return i};const gt=e=>{var{prefixCls:a,className:i,color:s="blue",dot:n,pending:o=!1,position:c,label:h,children:g}=e,l=vt(e,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:u}=r.useContext(se),f=u("timeline",a),p=k(`${f}-item`,{[`${f}-item-pending`]:o},i),y=/blue|red|green|gray/.test(s||"")?void 0:s,b=k(`${f}-item-head`,{[`${f}-item-head-custom`]:!!n,[`${f}-item-head-${s}`]:!y});return r.createElement("li",Object.assign({},l,{className:p}),h&&r.createElement("div",{className:`${f}-item-label`},h),r.createElement("div",{className:`${f}-item-tail`}),r.createElement("div",{className:b,style:{borderColor:y,color:y}},n),r.createElement("div",{className:`${f}-item-content`},g))},me=gt;var te=globalThis&&globalThis.__rest||function(e,a){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]]);return i};const jt=e=>{var{prefixCls:a,className:i,pending:s=!1,children:n,items:o,rootClassName:c,reverse:h=!1,direction:g,hashId:l,pendingDot:u,mode:f=""}=e,p=te(e,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const y=(x,N)=>f==="alternate"?x==="right"?`${a}-item-right`:x==="left"?`${a}-item-left`:N%2===0?`${a}-item-left`:`${a}-item-right`:f==="left"?`${a}-item-left`:f==="right"?`${a}-item-right`:x==="right"?`${a}-item-right`:"",b=ge(o||[]),C=typeof s=="boolean"?null:s;s&&b.push({pending:!!s,dot:u||r.createElement(je,null),children:C}),h&&b.reverse();const v=b.length,m=`${a}-item-last`,d=b.filter(x=>!!x).map((x,N)=>{var A;const q=N===v-2?m:"",fe=N===v-1?m:"",{className:xe}=x,ve=te(x,["className"]);return r.createElement(me,Object.assign({},ve,{className:k([xe,!h&&s?q:fe,y((A=x==null?void 0:x.position)!==null&&A!==void 0?A:"",N)]),key:(x==null?void 0:x.key)||N}))}),j=b.some(x=>!!(x!=null&&x.label)),$=k(a,{[`${a}-pending`]:!!s,[`${a}-reverse`]:!!h,[`${a}-${f}`]:!!f&&!j,[`${a}-label`]:j,[`${a}-rtl`]:g==="rtl"},i,c,l);return r.createElement("ul",Object.assign({},p,{className:$}),d)},yt=jt;function bt(e,a){return e&&Array.isArray(e)?e:ye(a).map(i=>{var s,n;return Object.assign({children:(n=(s=i==null?void 0:i.props)===null||s===void 0?void 0:s.children)!==null&&n!==void 0?n:""},i.props)})}const Nt=e=>{const{componentCls:a}=e;return{[a]:Object.assign(Object.assign({},Ce(e)),{margin:0,padding:0,listStyle:"none",[`${a}-item`]:{position:"relative",margin:0,paddingBottom:e.itemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.itemHeadSize,insetInlineStart:(e.itemHeadSize-e.tailWidth)/2,height:`calc(100% - ${e.itemHeadSize}px)`,borderInlineStart:`${e.tailWidth}px ${e.lineType} ${e.tailColor}`},"&-pending":{[`${a}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${a}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.itemHeadSize,height:e.itemHeadSize,backgroundColor:e.dotBg,border:`${e.dotBorderWidth}px ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:e.itemHeadSize/2,insetInlineStart:e.itemHeadSize/2,width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:-(e.fontSize*e.lineHeight-e.fontSize)+e.lineWidth,marginInlineStart:e.margin+e.itemHeadSize,marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${a}-item-tail`]:{display:"none"},[`> ${a}-item-content`]:{minHeight:e.controlHeightLG*1.2}}},[`&${a}-alternate,
        &${a}-right,
        &${a}-label`]:{[`${a}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:`-${e.marginXXS}px`,"&-custom":{marginInlineStart:e.tailWidth/2}},"&-left":{[`${a}-item-content`]:{insetInlineStart:`calc(50% - ${e.marginXXS}px)`,width:`calc(50% - ${e.marginSM}px)`,textAlign:"start"}},"&-right":{[`${a}-item-content`]:{width:`calc(50% - ${e.marginSM}px)`,margin:0,textAlign:"end"}}}},[`&${a}-right`]:{[`${a}-item-right`]:{[`${a}-item-tail,
            ${a}-item-head,
            ${a}-item-head-custom`]:{insetInlineStart:`calc(100% - ${(e.itemHeadSize+e.tailWidth)/2}px)`},[`${a}-item-content`]:{width:`calc(100% - ${e.itemHeadSize+e.marginXS}px)`}}},[`&${a}-pending
        ${a}-item-last
        ${a}-item-tail`]:{display:"block",height:`calc(100% - ${e.margin}px)`,borderInlineStart:`${e.tailWidth}px dotted ${e.tailColor}`},[`&${a}-reverse
        ${a}-item-last
        ${a}-item-tail`]:{display:"none"},[`&${a}-reverse ${a}-item-pending`]:{[`${a}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${e.margin}px)`,borderInlineStart:`${e.tailWidth}px dotted ${e.tailColor}`},[`${a}-item-content`]:{minHeight:e.controlHeightLG*1.2}},[`&${a}-label`]:{[`${a}-item-label`]:{position:"absolute",insetBlockStart:-(e.fontSize*e.lineHeight-e.fontSize)+e.tailWidth,width:`calc(50% - ${e.marginSM}px)`,textAlign:"end"},[`${a}-item-right`]:{[`${a}-item-label`]:{insetInlineStart:`calc(50% + ${e.marginSM}px)`,width:`calc(50% - ${e.marginSM}px)`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${a}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},Ct=be("Timeline",e=>{const a=Ne(e,{itemHeadSize:10,customHeadPaddingVertical:e.paddingXXS,paddingInlineEnd:2});return[Nt(a)]},e=>({tailColor:e.colorSplit,tailWidth:e.lineWidthBold,dotBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3,dotBg:e.colorBgContainer,itemPaddingBottom:e.padding*1.25}));var kt=globalThis&&globalThis.__rest||function(e,a){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]]);return i};const pe=e=>{const{getPrefixCls:a,direction:i,timeline:s}=r.useContext(se),{prefixCls:n,children:o,items:c,className:h,style:g}=e,l=kt(e,["prefixCls","children","items","className","style"]),u=a("timeline",n),[f,p]=Ct(u),y=bt(c,o);return f(r.createElement(yt,Object.assign({},l,{className:k(s==null?void 0:s.className,h),style:Object.assign(Object.assign({},s==null?void 0:s.style),g),prefixCls:u,direction:i,items:y,hashId:p})))};pe.Item=me;const St=pe;function $t(e){const a={},i={};return e.forEach(s=>{i[s.key]={key:s.key,title:s.title,type:s.type,children:[]}}),e.forEach(s=>{const n=s.pid,o=s.key;n===null?a[o]=i[o]:i[n].children.push(i[o])}),Object.values(a)}const It=e=>{const a=w(),{data:i}=e,n=T().state.project_id,[o,c]=J.useNotification();return t.jsxs("span",{style:{display:"inline"},onClick:()=>{ke(n,i.key,Se()).then(h=>{a(E())})},children:[t.jsx(ne,{}),c]})},_t=e=>{const i=T().state.project_id,s=w(),{data:n}=e,o=r.createContext(null),[c,h]=r.useState(!1),[g,l]=r.useState(!1),[u,f]=r.useState(!1),[p,y]=r.useState("确定要删除该节点吗？该操作不可逆!"),[b,C]=J.useNotification(),v=()=>{l(!0)},m=n.type=="FILE"?{project_id:i,folder_id:n.key}:{apis_id:n.key},d=()=>{y("节点正在删除中"),f(!0),l(!1),f(!1);const x=n.type==="FILE"?"/v1/folder/delete":"/v1/apis/delete";h(!0),D.post(x,m,{}).then(N=>{N.data.code==200?(h(!0),s(E()),n.type!=="FILE"&&s(oe(n.key))):((q=>{b.info({message:"错误提示",description:N.data.message,placement:q})})("topRight"),setTimeout(()=>{l(!1)},1500))}),s(P("gl"))},j=x=>{l(!1),x.stopPropagation()};function $(){v()}return t.jsxs("span",{style:{display:"inline"},onClick:$,children:[t.jsx(mt,{}),t.jsx(F,{title:"删除该节点",open:g,onOk:d,confirmLoading:u,onCancel:j,children:t.jsx("div",{children:t.jsx(o.Consumer,{children:()=>p})})}),ie.createPortal(t.jsx("div",{children:c&&t.jsxs($e,{tip:"Loading",size:"large",children:[t.jsx("div",{className:"content"}),C]})}),document.body)]})};const ue=e=>t.jsx("div",{children:e.value!=="FILE"?t.jsx("div",{className:`color-${e.value}`,children:t.jsx("div",{className:"ant-select-selection-item",children:e.value==="gl"?"":e.value})}):t.jsx("div",{children:t.jsx(Ie,{})})});const Ot=e=>{const[a,i]=J.useNotification(),s=w(),[n,o]=r.useState("");function c(u){u.stopPropagation(),o(u.target.value)}function h(){e.handleClick(!1),s(Q())}function g(u){(p=>{a.info({message:"错误提示",description:u,placement:p})})("topRight")}function l(u){u.stopPropagation(),e.title==="添加子目录"?D.post("/v1/folder/create",{project_id:e.data.project_id,parent_id:e.data.parent_id,name:n},{}).then(f=>{f.data.code==200?s(E()):g(f.data.message)}):D.post("/v1/folder/update",{folder_id:e.data.parent_id,parent_id:e.data.pid,name:n},{}).then(f=>{f.data.code==200?s(E()):alert(f.data.message)}),s(Q()),e.handleClick(!1)}return ie.createPortal(t.jsxs("div",{className:"createFile",onClick:u=>{u.stopPropagation()},children:[i,t.jsxs("div",{className:"createFile-title",children:[t.jsx("span",{children:t.jsx("h3",{children:e.title})}),t.jsx("span",{className:"createFile-title__icon",onClick:h,children:t.jsx(re,{})})]}),t.jsx("div",{className:"createFile-content",children:t.jsx(z,{placeholder:"请输入要创建的文件夹名字",value:n,onChange:c})}),t.jsx("div",{className:"createFile-btn",children:t.jsx(S,{size:"large",onClick:l,children:"创建"})})]}),document.body)};const wt=e=>{const{data:a}=e,{modal:i}=le.useApp(),s=w(),o=T().state.project_id,[c,h]=r.useState(!1),[g,l]=r.useState({project_id:o,parent_id:a.key,pid:a.pid}),{prijectInfo:u}=I(d=>({prijectInfo:d.project.projectInfo})),f=r.useCallback(d=>{s(Y()),h(!0),d.stopPropagation(),m("添加子目录")},[s]),p=r.useCallback(d=>{s(Y()),h(!0),d.stopPropagation(),m("修改文件夹名称")},[s]);r.useEffect(()=>{l({project_id:o,parent_id:a.key,pid:a.pid})},[a.key,a.pid,o]);const y=r.useCallback(async()=>{h(!1);const d=await _e(u.api_list,u.id);navigator.clipboard.writeText(d),i.success({title:"分享成功",content:t.jsxs("div",{children:[t.jsx("p",{children:"分享链接已经复制到剪切板"}),t.jsx("p",{style:{color:"#1677ff"},children:d})]})})},[i,u.api_list,u.id]),b=t.jsxs("div",{children:[t.jsx("div",{children:a.type==="FILE"?t.jsxs("div",{children:[t.jsx(S,{block:!0,onClick:f,children:"添加子目录"}),t.jsx(S,{block:!0,onClick:p,children:"更改文件夹名"})]}):t.jsx("div",{style:{display:"none"}})}),t.jsx("div",{children:t.jsx(S,{block:!0,onClick:y,children:"导出"})})]}),C=r.useCallback(d=>{h(d)},[]),[v,m]=r.useState("添加子目录");return t.jsxs("span",{children:[t.jsx(Oe,{content:b,title:"",trigger:"click",children:t.jsx(xt,{})}),c&&t.jsx(Ot,{handleClick:C,data:g,title:v}),c&&t.jsx(we,{data:1e4})]})},Pt=e=>{const[a,i]=r.useState(!1);function s(u){i(!a),u.stopPropagation()}const n=e.data.title,o={key:n.key,pid:n.pid,type:n.type},c={key:n.key,pid:n.pid,type:n.type},h={key:n.key,type:n.type},g=w();function l(){if(n.type!=="FILE"){const u={key:n.key,title:n.title,type:n.type};g(Pe(u)),g(P(n.key)),g(L(n.key))}}return t.jsxs("div",{className:"InterfaceBlock",onMouseEnter:s,onMouseLeave:s,onDoubleClick:l,children:[t.jsx("div",{className:"interface-type",children:t.jsx(ue,{value:n.type})}),t.jsx("div",{className:"InterfaceBlock-title",children:String(n.title)}),t.jsxs("div",{className:"btn",children:[a&&t.jsxs("div",{style:{display:"flex"},children:[n.pid!==null&&t.jsx(_t,{data:h}),n.type==="FILE"&&t.jsx("div",{children:t.jsx(It,{data:o})})]}),t.jsx(wt,{data:c})]})]})},Dt=O.memo(Pt);function B(e,a,i){const s=e.filter(l=>l.project_id===i),n=a.filter(l=>l.project_id===i);s.map(l=>{l.type="FILE"}),n.map(l=>{try{const u=De(l.request_data);l.type=u.getMethod()}catch{}}),n.map(l=>{l.parent_id=l.folder_id});const o=[...n,...s],c=[];o.map(l=>{const u={key:l.id,title:l.name,pid:l.parent_id,type:l.type};c.push(u)});const h=c;return h.map(l=>{l.title={key:l.key,title:l.title,pid:l.pid,type:l.type}}),h}const Et=()=>{const[e,a]=r.useState(!1),i=[{id:"694948f6-7908-4388-8da7-c744b13f76b6",project_id:1063,name:"根目录",parent_id:null}],[s,n]=r.useState(B(i,[],1063)),[o,c]=r.useState({value:s}),g=T().state.project_id,l=r.useCallback(()=>{a(!0),D.post("/v1/project/query",{projectid:g},{}).then(v=>{v.data.code==200&&(n(B(v.data.data.folder_list,v.data.data.api_list,g)),c({value:B(v.data.data.folder_list,v.data.data.api_list,g)}),v.data.data.folder_list,v.data.data.api_list,B(v.data.data.folder_list,v.data.data.api_list,g),a(!1))})},[g]),u=X(v=>v.watchDir.value);r.useEffect(()=>{l()},[l,u]);function f(v){const m=[];for(const d of v){const j={key:d.key,title:t.jsx(Dt,{data:{title:d.title,key:d.key,pid:d.pid,type:d.type}}),type:d.type,pid:d.pid};m.push(j)}return m}const p=w(),y=r.useCallback(v=>{if(v.node.type==="FILE"){const m=v.dragNode.type==="FILE"?"/v1/folder/update":"/v1/apis/update",d=v.dragNode.type==="FILE"?{folder_id:v.dragNodesKeys[0],parent_id:v.node.key}:{apis_id:v.dragNodesKeys[0],folder_id:v.node.key};a(!0),D.post(m,d,{}).then(j=>{p(E()),a(!0)})}},[p]),b=f(o.value),C=$t(b);return t.jsx("div",{className:"tree-part",children:(()=>e?t.jsx("div",{className:"loading",children:t.jsx(Ee,{style:{height:"100%"}})}):t.jsx(Me,{treeData:C,defaultExpandAll:!0,draggable:!0,blockNode:!0,onDrop:y,style:{width:"250px"},className:"renderTree"}))()})};const Mt=e=>{const{active:a,onRemoveTab:i,onSelected:s,index:n}=e,[o,c]=r.useState(!1);function h(){c(!o)}function g(l){l.stopPropagation(),i==null||i(n)}return t.jsxs("div",{className:k("tab",{"tab-active":a}),onMouseEnter:h,onMouseLeave:h,onClick:l=>s(n),children:[t.jsx("div",{className:"tab-title",children:t.jsx("span",{style:{marginRight:"7px"},children:t.jsx(ue,{value:e.data.type})})}),t.jsx("div",{className:"tab-content",children:t.jsx("span",{children:e.data.title})}),t.jsx("div",{className:"tab-closed",children:o&&t.jsx(re,{onClick:g})})]})};const Tt=()=>{const e=w(),{tabs:a,currentKey:i}=I(o=>({tabs:o.tabSlice.data,currentKey:o.tabSlice.currentKey}));r.useEffect(()=>{const o=a.find(c=>c.key===i);o.type==="gl"?e(P("gl")):e(P(o.key))},[i,e,a]),r.useEffect(()=>{a.length===0&&e(P("blank"))},[e,a]);const s=r.useCallback(o=>{let c=0;a.length>1&&(c=o===0?1:o-1),e(L(a[c].key)),e(Te(o))},[e,a]),n=r.useCallback(o=>{e(L(a[o].key))},[e,a]);return t.jsx("div",{className:"tabs",children:a.map((o,c)=>t.jsx(Mt,{data:o,active:o.key===i,onRemoveTab:s,onSelected:n,index:c},o.key))})},At=O.memo(Tt);const he=O.createContext({mode:"run"});function G(e){return function(a){return t.jsx(he.Consumer,{children:i=>t.jsx(e,{...a,...i})})}}const Bt=[{label:"Params",value:_.Params},{label:"Body",value:_.Body},{label:"Cookie",value:_.Cookie},{label:"Header",value:_.Header}],zt=e=>{const a=M(),{requestInfo:i}=I(p=>{let y={};return e.mode==="mock"?y=p.mock.mockData.apiInfo.request:y=p.mock.runData.apiInfo.request,{requestInfo:y}},ce),[s,n]=r.useState(_.Params),o=[{title:"参数名",dataIndex:"paramName",width:150,render:(p,y,b)=>t.jsx(z,{placeholder:"参数名",value:p,onChange:C=>c(C.target.value,"paramName",b)})},{title:"类型",width:150,render:(p,y,b)=>t.jsx(z,{placeholder:"类型",value:"string",style:{color:"#1677ff",textAlign:"center",fontWeight:"bold"}})},{title:"参数值",dataIndex:"value",render:(p,y,b)=>t.jsx(z,{placeholder:"参数值",value:p,onChange:C=>c(C.target.value,"value",b)})},{title:"操作",key:"action",width:50,align:"center",className:"action",render:(p,y,b)=>t.jsx(S,{type:"text",size:"small",onClick:()=>h(!1,b),block:!0,children:t.jsx(Be,{})})}],c=(p,y,b)=>{a(ze({key:y,value:p,index:b,paramType:s}))},h=(p,y)=>{a(Le({isInsert:p,removeIndex:y,paramType:s}))},g=()=>{switch(s){case _.Params:return i.params;case _.Header:return i.headers;case _.Cookie:return i.cookie;default:return[]}},l=p=>{a(Re(p))},u=()=>s===_.Body?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"section-title",style:{marginBottom:"10px"},children:"请输入JSON格式的请求体"}),t.jsx(R,{defaultValue:i.body,height:"200px",onChange:p=>l(p),withBorder:!0})]}):t.jsx(Ae,{dataSource:g(),columns:o,rowKey:"id",pagination:!1,footer:()=>f(),bordered:!0,size:"small"}),f=()=>t.jsx("div",{className:"param-footer",children:t.jsx(S,{type:"link",size:"small",onClick:()=>h(!0,-1),block:!0,children:t.jsx(ne,{})})});return t.jsxs("div",{className:"mock-request",children:[t.jsx("div",{className:"section-title",children:"请求参数"}),t.jsx("div",{className:"req-nav",children:Bt.map(p=>t.jsx("div",{className:k("nav-item",{active:s===p.value}),onClick:()=>n(p.value),children:p.label},p.value))}),t.jsx("div",{className:"content",children:u()})]})},Lt=r.memo(G(zt));const Rt=e=>{const a=M(),{responseInfo:i}=I(s=>{const n={};return e.mode==="mock"?n.responseInfo=s.mock.mockData.apiInfo.response:n.responseInfo=s.mock.runData.apiInfo.response,n});return t.jsxs("div",{className:"response-page",children:[t.jsx("div",{className:"section-title",children:"返回响应"}),t.jsx("div",{className:"content",children:t.jsx(R,{defaultValue:i.body,height:"200px",withBorder:!0,onChange:s=>e.mode==="run"&&a(V(s)),readOnly:e.mode==="mock"})})]})},qt=r.memo(G(Rt));const Ht=e=>{const{mode:a}=e,[i,s]=r.useState("https://lyyfsq.club:7000/api/v1/mock/project_id"),n=M(),{userReqInfo:o,reqParams:c,projectId:h,metaInfo:g,apiData:l}=I(m=>{const d={};return a==="mock"?(d.userReqInfo=m.mock.mockData.apiInfo.base,d.reqParams=m.mock.mockData.apiInfo.request,d.metaInfo=m.mock.mockData.meta_info,d.apiData=m.mock.mockData):(d.userReqInfo=m.mock.runData.apiInfo.base,d.reqParams=m.mock.runData.apiInfo.request,d.metaInfo=m.mock.runData.meta_info,d.apiData=m.mock.runData),{...d,projectId:m.project.projectInfo.id}});r.useEffect(()=>s(`https://lyyfsq.club:7000/api/v1/mock/${h}`),[h]);const[u,f]=r.useState({label:"GET",value:"GET"});r.useEffect(()=>{f({label:o.method,value:o.method})},[o]);const p=(m,d)=>{const j=m.target.value;n(d==="prefix"?He(j):Fe(j))},y=m=>{f(m),n(Ve(m.value))},b=async()=>{const m={},d={};let j="";c.params.forEach(N=>m[N.paramName]=N.value),c.cookie.forEach(N=>j+=`${N.paramName}=${N.value}; `),m.Cookie=j,c.params.forEach(N=>d[N.paramName]=N.value);let $=`${o.prefix}/${o.path}`;a==="mock"&&($=`https://lyyfsq.club:7000/api/v1/mock/${h}/${o.path}`);const{data:x}=await We({url:$,method:o.method,headers:m,data:c.body});try{const N=JSON.stringify(x);n(V(N))}catch{n(V(x+""))}},C=async()=>{const m={},d={};let j="";c.params.forEach(x=>m[x.paramName]=x.value),c.cookie.forEach(x=>j+=`${x.paramName}=${x.value}; `),m.Cookie=j,c.params.forEach(x=>d[x.paramName]=x.value),(await Ke({project_id:h,url:"/"+o.path,method:o.method.toLowerCase(),apis_id:g.api_id,name:g.name,headers:JSON.stringify(m),params:JSON.stringify(d),response:v(l.apiInfo.response.body),data:l.apiInfo.response.body})).code===200&&Ue.success("创建成功")},v=m=>{let d={};try{d={example:JSON.parse(m)}}catch{d={example:{data:m}}}return JSON.stringify(d),JSON.stringify(d)};return t.jsx("div",{className:"doc-operator",children:t.jsxs(qe,{methodValue:u,onOptionChange:m=>y(m),onPrefixInputChange:m=>p(m,"prefix"),onInputChange:m=>p(m,"path"),inputValue:o.path,urlPrefixValue:a==="run"?o.prefix:i,disablePrefix:a==="mock",rightWidth:a==="mock"?"250px":"150px",children:[t.jsx(S,{className:"btn",type:"primary",onClick:b,children:"发送"}),a==="mock"&&t.jsx(S,{type:"primary",style:{marginLeft:"10px"},onClick:C,children:"创建Mock"})]})})},Ft=r.memo(G(Ht)),ae=e=>{const{mode:a,project_id:i}=e,{apiId:s}=I(o=>({apiId:o.rightSlice.value})),n=M();return r.useEffect(()=>{s!=="gl"&&(n(Je(a)),n(Xe(s)))},[n,s,a]),t.jsx("div",{children:t.jsx("div",{className:"mock-page",children:t.jsxs(he.Provider,{value:{...e},children:[t.jsx(Ft,{mode:a}),t.jsx(Lt,{mode:"run"}),t.jsx(qt,{mode:a})]})})})};const Vt=[{label:"JavaScirpt",key:"1"},{label:"Java",key:"2"},{label:"Go",key:"3"}],ca=[{label:"Native",key:"1"}],da=[{label:"Unirest",key:"1"},{label:"OkHttp",key:"2"}],ma=[{label:"fetch",key:"1"},{label:"axios",key:"2"},{label:"jquery",key:"3"},{label:"request",key:"4"},{label:"XHR",key:"5"}],Wt=()=>{const[e,a]=r.useState("1"),i=n=>{a(n.key)};let s=null;return s=e==="1"?O.lazy(()=>H(()=>import("./JSCodeContent-324f6e1f.js"),["assets/JSCodeContent-324f6e1f.js","assets/index-0b453699.js","assets/index-76b74f02.css"])):e==="2"?O.lazy(()=>H(()=>import("./JavaCodeContent-f3dd29d0.js"),["assets/JavaCodeContent-f3dd29d0.js","assets/index-0b453699.js","assets/index-76b74f02.css"])):O.lazy(()=>H(()=>import("./GoCodeContent-0533e8b8.js"),["assets/GoCodeContent-0533e8b8.js","assets/index-0b453699.js","assets/index-76b74f02.css"])),t.jsx(O.Suspense,{fallback:t.jsx("div",{children:"Loading..."}),children:t.jsx("div",{className:"codeTemplate",children:t.jsxs("div",{className:"codeTemplate-body",children:[t.jsx(de,{onClick:i,style:{width:120},defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],mode:"inline",items:Vt}),t.jsx(s,{})]})})})};async function Kt(e){const a=await D.post("/v1/apis/queryversion",{apis_id:e},{}),i=[];return a.data.data.map(s=>{i.push({id:s.id,notes:s.notes})}),i}async function Ut(e){return(await D.post("/v1/apis/back",{version_id:e},{})).data.message}const Jt=e=>{const a=r.useRef([]),[i,s]=r.useState([]);return r.useEffect(()=>{Kt(e.apis_id).then(n=>{a.current=n;const o=[];a.current.map(c=>{o.push({children:t.jsx("div",{className:"versionNotes",onClick:async()=>{await Ut(c.id),window.location.reload()},children:c.notes})})}),s(o)})},[e.apis_id]),t.jsx("div",{className:"versionBack",children:t.jsx(St,{items:i})})},Xt=O.memo(Jt),Gt=r.memo(()=>{const{message:e,modal:a}=le.useApp(),i=M(),{metaInfo:s,ownerInfo:n,folderName:o,apiId:c,baseInfo:h}=I(j=>({metaInfo:j.document.apiData.meta_info,ownerInfo:j.document.ownerUser,folderName:j.document.folderName,apiId:j.document.apiId,baseInfo:j.document.apiData.apiInfo.base}));function g(){const j=async()=>{const $=await Qe(c);$.code===200?e.success($.message):e.error($.message),i(E()),i(oe(c)),i(P("gl"))};a.confirm({title:"删除接口",content:"确定要删除该接口吗？删除后不可恢复",onOk:j,onCancel:()=>{}})}const[l,u]=r.useState(!1),[f,p]=r.useState(!1),y=()=>{p(!0)},b=j=>{p(!1)},C=j=>{p(!1)},v=j=>{u(!1)},m=j=>{u(!1)};function d(){u(!0)}return t.jsxs("div",{className:"intro-request",children:[t.jsx(F,{title:t.jsx("div",{children:"生成代码"}),open:l,onOk:v,onCancel:m,width:660,children:t.jsx(Wt,{})}),t.jsx(F,{title:t.jsx("div",{children:"历史版本(点击记录即回滚)"}),open:f,onOk:b,onCancel:C,children:t.jsx(Xt,{apis_id:c})}),t.jsxs("div",{className:"name-wrap",children:[t.jsx("div",{className:k("method","method-"+h.method.toLowerCase()),children:h.method}),t.jsx("div",{className:"title",children:s.name}),t.jsxs("div",{className:"opt-wrap",children:[t.jsx(S,{type:"primary",onClick:d,children:"生成代码"}),t.jsx(S,{style:{marginLeft:"10px"},onClick:y,children:"版本回滚"}),t.jsx(S,{style:{marginLeft:"10px",marginRight:"20px"},onClick:g,danger:!0,children:"删除"})]})]}),t.jsxs("div",{className:"meta-info",children:[t.jsxs("div",{className:"meta-item",children:[t.jsx("span",{className:"title",children:"创建时间"}),t.jsx("span",{className:"val",children:Ge(s.created)})]}),t.jsxs("div",{className:"meta-item",children:[t.jsx("span",{className:"title",children:"创建者"}),t.jsx("span",{className:"val",children:n.username})]}),t.jsxs("div",{className:"meta-item",children:[t.jsx("span",{className:"title",children:"所在目录"}),t.jsx("span",{className:"val",children:o})]})]})]})});const Qt=r.memo(()=>{const{requestInfo:e}=I(s=>({requestInfo:s.document.apiData.apiInfo.request}));function a(s){return s==="body"?t.jsx(W,{size:"small",title:s.slice(0,1).toUpperCase()+s.slice(1),style:{width:"100%"},children:t.jsxs("div",{className:"code-card-body-info",children:[t.jsx("span",{className:"body-title",children:"示例值"}),t.jsx("div",{className:"body-content",children:t.jsx(R,{height:"250px",lang:"json",readOnly:!0,withBorder:!0,defaultValue:e[s]})})]})}):t.jsx(W,{size:"small",title:s.slice(0,1).toUpperCase()+s.slice(1),style:{width:"100%"},children:e[s].map(n=>i(n))})}function i(s){return t.jsxs("div",{className:"param-kv",children:[t.jsxs("div",{className:"type",children:[t.jsx("div",{className:"param-name label",children:t.jsx(Z,{color:"cyan",children:s.paramName})}),t.jsx("div",{className:"param-type",children:s.type}),t.jsx("div",{className:"require",children:t.jsx(Z,{color:"default",children:s.required?"必选":"可选"})})]}),t.jsxs("div",{className:"example",children:[t.jsx("div",{className:"label",children:"示例值"}),t.jsx("div",{className:"val",children:t.jsx("div",{className:"example-tag",children:s.value?s.value:"无"})})]})]},s.id)}return t.jsxs("div",{className:"intro-req",children:[t.jsx("div",{className:"setction-title",children:"请求参数"}),t.jsx("div",{className:"req-content",children:Object.keys(e).map(s=>t.jsx("div",{className:"param-item",children:a(s)},s))})]})});const Yt=r.memo(()=>{const{apiData:e}=I(a=>({apiData:a.document.apiData}),ce);return e.apiInfo.response.body,t.jsxs("div",{className:"intro-response",children:[t.jsx("div",{className:"setction-title",children:"返回响应"}),t.jsx("div",{className:"content",children:t.jsx(W,{size:"small",title:"响应示例",extra:t.jsx("a",{href:"#",children:"生成代码"}),style:{width:"100%"},children:t.jsx("div",{className:"content-value",children:t.jsxs("div",{className:"code-card-body-info",children:[t.jsx("span",{className:"body-title",children:"示例值"}),t.jsx("div",{className:"body-content",children:t.jsx(R,{height:"250px",lang:"json",readOnly:!0,withBorder:!0,defaultValue:e.apiInfo.response.body})})]})})})})]})});const Zt=e=>{const a=M(),{apiId:i}=I(s=>({apiId:s.rightSlice.value}));return r.useEffect(()=>{i!=="gl"&&a(Ye(i))},[a,i]),t.jsxs("div",{className:"introduction-page",children:[t.jsx(Gt,{}),t.jsx(Qt,{}),t.jsx(Yt,{})]})},ea=r.memo(Zt),ta=[{label:"文档",key:"1"},{label:"修改文档",key:"2"},{label:"运行",key:"3"},{label:"Mock",key:"4"}],aa=e=>{const{data:a,project_id:i}=e,[s,n]=r.useState("1"),o=c=>{n(c.key)};return t.jsxs("div",{className:"doc-area",children:[t.jsx(de,{onClick:o,selectedKeys:[s],mode:"horizontal",items:ta}),t.jsx("div",{className:"panel",children:s==="1"?t.jsx(ea,{data:a}):s==="2"?t.jsx(Ze,{data:a}):s==="3"?t.jsx(ae,{mode:"run",project_id:i}):t.jsx(ae,{mode:"mock",project_id:i})})]})};const sa=r.memo(()=>t.jsxs("div",{className:"logo-page",children:[t.jsx("div",{className:"text large-text",children:"🍻🍻"}),t.jsx("div",{className:"text",children:"ApiKnight"}),t.jsx("div",{className:"text small-text",children:["干杯！","今天有什么有趣的事情呢","轻舟已过万重山"][Math.floor(Math.random()*3)]})]})),na=e=>{const a=X(i=>i.rightSlice.value);return t.jsxs("div",{className:"right-component-wrap",children:[a=="gl"&&t.jsx(et,{}),a==="blank"&&t.jsx(sa,{}),a!=="gl"&&a!=="blank"&&t.jsx(aa,{data:a,project_id:e.project_id})]})};const ia=e=>{const a=X(i=>i.rightSlice.value);return t.jsxs("div",{className:k("cpn-right-page full-height"),children:[t.jsx("div",{className:k("tabs-wrap",{hidden:a==="blank"}),children:t.jsx(At,{})}),t.jsx("div",{className:k("other-wrap"),children:t.jsx(na,{project_id:e.project_id})})]})},oa=O.memo(ia),ra=()=>{tt().start();const e=w(),{currentKey:a}=I(o=>({currentKey:o.tabSlice.currentKey})),s=T().state.project_id;function n(){e(at({item:{key:"project-summary",title:"项目概览",type:"gl"},index:0})),e(L("project-summary")),e(P("gl"))}return t.jsxs("div",{className:"project-api",children:[t.jsxs("div",{className:"project-api-left",children:[t.jsx(S,{type:"dashed",className:k("opt-item",{"opt-item-active":a==="project-summary"}),icon:t.jsx(ee,{}),onClick:n,children:"项目概览"}),t.jsx(S,{type:"dashed",className:k("opt-item",{"opt-item-active":a!=="project-summary"}),icon:t.jsx(ee,{}),onClick:n,children:"接口"}),t.jsx("div",{className:"api-dir",children:t.jsx(Et,{})})]}),t.jsx("div",{className:"project-api-right",children:t.jsx(oa,{project_id:s})})]})},pa=Object.freeze(Object.defineProperty({__proto__:null,default:ra},Symbol.toStringTag,{value:"Module"}));export{da as a,ca as b,pa as c,ma as i};
