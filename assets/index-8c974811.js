import{r as o,A as U,_ as J,C as se,c as k,a as ge,L as je,t as ye,g as be,m as Ne,b as Ce,R as _,u as O,d as T,n as X,j as e,e as ke,f as Se,i as E,P as ne,M as V,h as ie,S as $e,k as D,l as re,s as P,F as Ie,o as oe,I as B,B as S,p as Q,q as le,v as I,w as _e,O as Oe,x as Y,y as we,z as Pe,D as z,E as De,G as L,H as Ee,T as Me,J as Te,N as w,K as M,Q as ce,U as q,V as Ae,W as Be,X as ze,Y as Le,Z as qe,$ as W,a0 as He,a1 as Re,a2 as Fe,a3 as Ve,a4 as We,a5 as Ke,a6 as Ue,a7 as Je,a8 as Xe,a9 as R,aa as de,ab as Ge,ac as Qe,ad as K,ae as Z,af as Ye,ag as Ze,ah as et,ai as tt,aj as at}from"./index-8a3e701d.js";var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 680h-54V540H546v-92h238c8.8 0 16-7.2 16-16V168c0-8.8-7.2-16-16-16H240c-8.8 0-16 7.2-16 16v264c0 8.8 7.2 16 16 16h238v92H190v140h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8zM256 805.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zm288 0c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM288 384V216h448v168H288zm544 421.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM360 300a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"cluster",theme:"outlined"};const nt=st;var it=function(a,i){return o.createElement(U,J({},a,{ref:i,icon:nt}))};const ee=o.forwardRef(it);var rt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"};const ot=rt;var lt=function(a,i){return o.createElement(U,J({},a,{ref:i,icon:ot}))};const ct=o.forwardRef(lt);var dt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};const mt=dt;var pt=function(a,i){return o.createElement(U,J({},a,{ref:i,icon:mt}))};const ht=o.forwardRef(pt);var ut=globalThis&&globalThis.__rest||function(t,a){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&a.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(i[s[n]]=t[s[n]]);return i};const ft=t=>{var{prefixCls:a,className:i,color:s="blue",dot:n,pending:r=!1,position:l,label:f,children:g}=t,c=ut(t,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:h}=o.useContext(se),u=h("timeline",a),p=k(`${u}-item`,{[`${u}-item-pending`]:r},i),j=/blue|red|green|gray/.test(s||"")?void 0:s,b=k(`${u}-item-head`,{[`${u}-item-head-custom`]:!!n,[`${u}-item-head-${s}`]:!j});return o.createElement("li",Object.assign({},c,{className:p}),f&&o.createElement("div",{className:`${u}-item-label`},f),o.createElement("div",{className:`${u}-item-tail`}),o.createElement("div",{className:b,style:{borderColor:j,color:j}},n),o.createElement("div",{className:`${u}-item-content`},g))},me=ft;var te=globalThis&&globalThis.__rest||function(t,a){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&a.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(i[s[n]]=t[s[n]]);return i};const xt=t=>{var{prefixCls:a,className:i,pending:s=!1,children:n,items:r,rootClassName:l,reverse:f=!1,direction:g,hashId:c,pendingDot:h,mode:u=""}=t,p=te(t,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const j=(x,N)=>u==="alternate"?x==="right"?`${a}-item-right`:x==="left"?`${a}-item-left`:N%2===0?`${a}-item-left`:`${a}-item-right`:u==="left"?`${a}-item-left`:u==="right"?`${a}-item-right`:x==="right"?`${a}-item-right`:"",b=ge(r||[]),C=typeof s=="boolean"?null:s;s&&b.push({pending:!!s,dot:h||o.createElement(je,null),children:C}),f&&b.reverse();const y=b.length,m=`${a}-item-last`,d=b.filter(x=>!!x).map((x,N)=>{var A;const H=N===y-2?m:"",fe=N===y-1?m:"",{className:xe}=x,ve=te(x,["className"]);return o.createElement(me,Object.assign({},ve,{className:k([xe,!f&&s?H:fe,j((A=x==null?void 0:x.position)!==null&&A!==void 0?A:"",N)]),key:(x==null?void 0:x.key)||N}))}),v=b.some(x=>!!(x!=null&&x.label)),$=k(a,{[`${a}-pending`]:!!s,[`${a}-reverse`]:!!f,[`${a}-${u}`]:!!u&&!v,[`${a}-label`]:v,[`${a}-rtl`]:g==="rtl"},i,l,c);return o.createElement("ul",Object.assign({},p,{className:$}),d)},vt=xt;function gt(t,a){return t&&Array.isArray(t)?t:ye(a).map(i=>{var s,n;return Object.assign({children:(n=(s=i==null?void 0:i.props)===null||s===void 0?void 0:s.children)!==null&&n!==void 0?n:""},i.props)})}const jt=t=>{const{componentCls:a}=t;return{[a]:Object.assign(Object.assign({},Ce(t)),{margin:0,padding:0,listStyle:"none",[`${a}-item`]:{position:"relative",margin:0,paddingBottom:t.itemPaddingBottom,fontSize:t.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:t.itemHeadSize,insetInlineStart:(t.itemHeadSize-t.tailWidth)/2,height:`calc(100% - ${t.itemHeadSize}px)`,borderInlineStart:`${t.tailWidth}px ${t.lineType} ${t.tailColor}`},"&-pending":{[`${a}-item-head`]:{fontSize:t.fontSizeSM,backgroundColor:"transparent"},[`${a}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:t.itemHeadSize,height:t.itemHeadSize,backgroundColor:t.dotBg,border:`${t.dotBorderWidth}px ${t.lineType} transparent`,borderRadius:"50%","&-blue":{color:t.colorPrimary,borderColor:t.colorPrimary},"&-red":{color:t.colorError,borderColor:t.colorError},"&-green":{color:t.colorSuccess,borderColor:t.colorSuccess},"&-gray":{color:t.colorTextDisabled,borderColor:t.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:t.itemHeadSize/2,insetInlineStart:t.itemHeadSize/2,width:"auto",height:"auto",marginBlockStart:0,paddingBlock:t.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:-(t.fontSize*t.lineHeight-t.fontSize)+t.lineWidth,marginInlineStart:t.margin+t.itemHeadSize,marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${a}-item-tail`]:{display:"none"},[`> ${a}-item-content`]:{minHeight:t.controlHeightLG*1.2}}},[`&${a}-alternate,
        &${a}-right,
        &${a}-label`]:{[`${a}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:`-${t.marginXXS}px`,"&-custom":{marginInlineStart:t.tailWidth/2}},"&-left":{[`${a}-item-content`]:{insetInlineStart:`calc(50% - ${t.marginXXS}px)`,width:`calc(50% - ${t.marginSM}px)`,textAlign:"start"}},"&-right":{[`${a}-item-content`]:{width:`calc(50% - ${t.marginSM}px)`,margin:0,textAlign:"end"}}}},[`&${a}-right`]:{[`${a}-item-right`]:{[`${a}-item-tail,
            ${a}-item-head,
            ${a}-item-head-custom`]:{insetInlineStart:`calc(100% - ${(t.itemHeadSize+t.tailWidth)/2}px)`},[`${a}-item-content`]:{width:`calc(100% - ${t.itemHeadSize+t.marginXS}px)`}}},[`&${a}-pending
        ${a}-item-last
        ${a}-item-tail`]:{display:"block",height:`calc(100% - ${t.margin}px)`,borderInlineStart:`${t.tailWidth}px dotted ${t.tailColor}`},[`&${a}-reverse
        ${a}-item-last
        ${a}-item-tail`]:{display:"none"},[`&${a}-reverse ${a}-item-pending`]:{[`${a}-item-tail`]:{insetBlockStart:t.margin,display:"block",height:`calc(100% - ${t.margin}px)`,borderInlineStart:`${t.tailWidth}px dotted ${t.tailColor}`},[`${a}-item-content`]:{minHeight:t.controlHeightLG*1.2}},[`&${a}-label`]:{[`${a}-item-label`]:{position:"absolute",insetBlockStart:-(t.fontSize*t.lineHeight-t.fontSize)+t.tailWidth,width:`calc(50% - ${t.marginSM}px)`,textAlign:"end"},[`${a}-item-right`]:{[`${a}-item-label`]:{insetInlineStart:`calc(50% + ${t.marginSM}px)`,width:`calc(50% - ${t.marginSM}px)`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${a}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},yt=be("Timeline",t=>{const a=Ne(t,{itemHeadSize:10,customHeadPaddingVertical:t.paddingXXS,paddingInlineEnd:2});return[jt(a)]},t=>({tailColor:t.colorSplit,tailWidth:t.lineWidthBold,dotBorderWidth:t.wireframe?t.lineWidthBold:t.lineWidth*3,dotBg:t.colorBgContainer,itemPaddingBottom:t.padding*1.25}));var bt=globalThis&&globalThis.__rest||function(t,a){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&a.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(i[s[n]]=t[s[n]]);return i};const pe=t=>{const{getPrefixCls:a,direction:i,timeline:s}=o.useContext(se),{prefixCls:n,children:r,items:l,className:f,style:g}=t,c=bt(t,["prefixCls","children","items","className","style"]),h=a("timeline",n),[u,p]=yt(h),j=gt(l,r);return u(o.createElement(vt,Object.assign({},c,{className:k(s==null?void 0:s.className,f),style:Object.assign(Object.assign({},s==null?void 0:s.style),g),prefixCls:h,direction:i,items:j,hashId:p})))};pe.Item=me;const Nt=pe;function Ct(t){const a={},i={};return t.forEach(s=>{i[s.key]={key:s.key,title:s.title,type:s.type,children:[]}}),t.forEach(s=>{const n=s.pid,r=s.key;n===null?a[r]=i[r]:i[n].children.push(i[r])}),Object.values(a)}_.createContext({name:"Default"});const kt=t=>{const a=O(),{data:i}=t,n=T().state.project_id,[r,l]=X.useNotification();return o.useMemo(()=>({name:"错误提示"}),[]),e.jsxs("span",{style:{display:"inline"},onClick:()=>{ke(n,i.key,Se()).then(f=>{a(E())})},children:[e.jsx(ne,{}),l]})},St=t=>{const i=T().state.project_id,s=O(),{data:n}=t,r=o.createContext(null),[l,f]=o.useState(!1),[g,c]=o.useState(!1),[h,u]=o.useState(!1),[p,j]=o.useState("确定要删除该节点吗？该操作不可逆!"),[b,C]=X.useNotification(),y=()=>{c(!0)},m=n.type=="FILE"?{project_id:i,folder_id:n.key}:{apis_id:n.key},d=()=>{j("节点正在删除中"),u(!0),c(!1),u(!1);const x=n.type==="FILE"?"/v1/folder/delete":"/v1/apis/delete";f(!0),D.post(x,m,{}).then(N=>{N.data.code==200?(f(!0),s(E()),n.type!=="FILE"&&s(re(n.key))):((H=>{b.info({message:"错误提示",description:N.data.message,placement:H})})("topRight"),setTimeout(()=>{c(!1)},1500))}),s(P("gl"))},v=x=>{c(!1),x.stopPropagation()};function $(){y()}return e.jsxs("span",{style:{display:"inline"},onClick:$,children:[e.jsx(ct,{}),e.jsx(V,{title:"删除该节点",open:g,onOk:d,confirmLoading:h,onCancel:v,children:e.jsx("div",{children:e.jsx(r.Consumer,{children:()=>p})})}),ie.createPortal(e.jsx("div",{children:l&&e.jsxs($e,{tip:"Loading",size:"large",children:[e.jsx("div",{className:"content"}),C]})}),document.body)]})};const he=t=>e.jsx("div",{children:t.value!=="FILE"?e.jsx("div",{className:`color-${t.value}`,children:e.jsx("div",{className:"ant-select-selection-item",children:t.value==="gl"?"":t.value})}):e.jsx("div",{children:e.jsx(Ie,{})})});const $t=t=>{const[a,i]=X.useNotification(),s=O(),[n,r]=o.useState("");function l(h){h.stopPropagation(),r(h.target.value)}function f(){t.handleClick(!1),s(Q())}function g(h){(p=>{a.info({message:"错误提示",description:h,placement:p})})("topRight")}function c(h){h.stopPropagation(),t.title==="添加子目录"?D.post("/v1/folder/create",{project_id:t.data.project_id,parent_id:t.data.parent_id,name:n},{}).then(u=>{u.data.code==200?s(E()):g(u.data.message)}):D.post("/v1/folder/update",{folder_id:t.data.parent_id,parent_id:t.data.pid,name:n},{}).then(u=>{u.data.code==200?s(E()):alert(u.data.message)}),s(Q()),t.handleClick(!1)}return ie.createPortal(e.jsxs("div",{className:"createFile",onClick:h=>{h.stopPropagation()},children:[i,e.jsxs("div",{className:"createFile-title",children:[e.jsx("span",{children:e.jsx("h3",{children:t.title})}),e.jsx("span",{className:"createFile-title__icon",onClick:f,children:e.jsx(oe,{})})]}),e.jsx("div",{className:"createFile-content",children:e.jsx(B,{placeholder:"请输入要创建的文件夹名字",value:n,onChange:l})}),e.jsx("div",{className:"createFile-btn",children:e.jsx(S,{size:"large",onClick:c,children:"创建"})})]}),document.body)};const It=t=>{const{data:a}=t,{modal:i}=le.useApp(),s=O(),{prijectInfo:n}=I(d=>({prijectInfo:d.project.projectInfo}));function r(d){s(Y()),p(!0),d.stopPropagation(),m("添加子目录")}function l(d){s(Y()),p(!0),d.stopPropagation(),m("修改文件夹名称")}o.useEffect(()=>{b({project_id:h,parent_id:a.key,pid:a.pid})},[]);async function f(){p(!1);const d=await we(n.api_list,n.id);navigator.clipboard.writeText(d),i.success({title:"分享成功",content:e.jsxs("div",{children:[e.jsx("p",{children:"分享链接已经复制到剪切板"}),e.jsx("p",{style:{color:"#1677ff"},children:d})]})})}const g=e.jsxs("div",{children:[e.jsx("div",{children:a.type==="FILE"?e.jsxs("div",{children:[e.jsx(S,{block:!0,onClick:r,children:"添加子目录"}),e.jsx(S,{block:!0,onClick:l,children:"更改文件夹名"})]}):e.jsx("div",{style:{display:"none"}})}),e.jsx("div",{children:e.jsx(S,{block:!0,onClick:f,children:"导出"})})]}),h=T().state.project_id,[u,p]=o.useState(!1),[j,b]=o.useState({project_id:h,parent_id:a.key,pid:a.pid}),C=d=>{p(d)},[y,m]=o.useState("添加子目录");return e.jsxs("span",{children:[e.jsx(_e,{content:g,title:"",trigger:"click",children:e.jsx(ht,{})}),u&&e.jsx($t,{handleClick:C,data:j,title:y}),u&&e.jsx(Oe,{data:1e4})]})},_t=t=>{const[a,i]=o.useState(!1);function s(h){i(!a),h.stopPropagation()}const{title:n}=t.data,r={key:n.key,pid:n.pid,type:n.type},l={key:n.key,pid:n.pid,type:n.type},f={key:n.key,type:n.type},g=O();function c(){if(n.type!=="FILE"){const h={key:n.key,title:n.title,type:n.type};g(Pe(h)),g(P(n.key)),g(z(n.key))}}return e.jsxs("div",{className:"InterfaceBlock",onMouseEnter:s,onMouseLeave:s,onDoubleClick:c,children:[e.jsx("div",{className:"interface-type",children:e.jsx(he,{value:n.type})}),e.jsx("div",{className:"InterfaceBlock-title",children:n.title}),e.jsxs("div",{className:"btn",children:[a&&e.jsxs("div",{style:{display:"flex"},children:[n.pid!==null&&e.jsx(St,{data:f}),n.type==="FILE"&&e.jsx("div",{children:e.jsx(kt,{data:r})})]}),e.jsx(It,{data:l})]})]})},Ot=_.memo(_t);function F(t,a,i){let s=t.filter(c=>c.project_id===i),n=a.filter(c=>c.project_id===i);s.map(c=>{c.type="FILE"}),n.map(c=>{try{let h=De(c.request_data);c.type=h.getMethod()}catch{}}),n.map(c=>{c.parent_id=c.folder_id});const r=[...n,...s];let l=[];r.map(c=>{const h={key:c.id,title:c.name,pid:c.parent_id,type:c.type};l.push(h)});let f=l;return f.map(c=>{c.title={key:c.key,title:c.title,pid:c.pid,type:c.type}}),f}const wt=()=>{const[t,a]=o.useState(!1),i=[{id:"694948f6-7908-4388-8da7-c744b13f76b6",project_id:1063,name:"根目录",parent_id:null}],[s,n]=o.useState(F(i,[],1063)),[r,l]=o.useState({value:s}),g=T().state.project_id;function c(){a(!0),D.post("/v1/project/query",{projectid:g},{}).then(y=>{y.data.code==200&&(n(F(y.data.data.folder_list,y.data.data.api_list,g)),l({value:F(y.data.data.folder_list,y.data.data.api_list,g)}),a(!1))})}const h=L(y=>y.watchDir.value);o.useEffect(()=>{c()},[h]);function u(y){const m=[];for(const d of y){const v={key:d.key,title:e.jsx(Ot,{data:{title:d.title,key:d.key,pid:d.pid,type:d.type}}),type:d.type,pid:d.pid};m.push(v)}return m}const p=O(),j=y=>{if(y.node.type==="FILE"){const m=y.dragNode.type==="FILE"?"/v1/folder/update":"/v1/apis/update",d=y.dragNode.type==="FILE"?{folder_id:y.dragNodesKeys[0],parent_id:y.node.key}:{apis_id:y.dragNodesKeys[0],folder_id:y.node.key};a(!0),D.post(m,d,{}).then(v=>{p(E()),a(!0)})}},b=u(r.value),C=Ct(b);return e.jsx("div",{className:"tree-part",children:(()=>t?e.jsx("div",{className:"loading",children:e.jsx(Ee,{style:{height:"100%"}})}):e.jsx(Me,{treeData:C,defaultExpandAll:!0,draggable:!0,blockNode:!0,onDrop:j,style:{width:"250px"},className:"renderTree"}))()})};const Pt=t=>{const{active:a,data:i,onRemoveTab:s,onSelected:n,index:r}=t,[l,f]=o.useState(!1);O();function g(){f(!l)}function c(h){h.stopPropagation(),s==null||s(r)}return e.jsxs("div",{className:k("tab",{"tab-active":a}),onMouseEnter:g,onMouseLeave:g,onClick:h=>n(r),children:[e.jsx("div",{className:"tab-title",children:e.jsx("span",{style:{marginRight:"7px"},children:e.jsx(he,{value:t.data.type})})}),e.jsx("div",{className:"tab-content",children:e.jsx("span",{children:t.data.title})}),e.jsx("div",{className:"tab-closed",children:l&&e.jsx(oe,{onClick:c})})]})};const Dt=()=>{const t=O(),{tabs:a,currentKey:i}=I(r=>({tabs:r.tabSlice.data,currentKey:r.tabSlice.currentKey}));o.useEffect(()=>{const r=a.find(l=>l.key===i);r.type==="gl"?t(P("gl")):t(P(r.key))},[i]),o.useEffect(()=>{a.length===0&&t(P("blank"))},[a]);function s(r){let l=0;a.length>1&&(l=r===0?1:r-1),t(z(a[l].key)),t(Te(r))}function n(r){t(z(a[r].key))}return e.jsx("div",{className:"tabs",children:a.map((r,l)=>e.jsx(Pt,{data:r,active:r.key===i,onRemoveTab:s,onSelected:n,index:l},r.key))})},Et=_.memo(Dt);const ue=_.createContext({mode:"run"});function G(t){return function(a){return e.jsx(ue.Consumer,{children:i=>e.jsx(t,{...a,...i})})}}const Mt=[{label:"Params",value:w.Params},{label:"Body",value:w.Body},{label:"Cookie",value:w.Cookie},{label:"Header",value:w.Header}],Tt=t=>{const a=M(),{requestInfo:i}=I(p=>{let j={};return t.mode==="mock"?j=p.mock.mockData.apiInfo.request:j=p.mock.runData.apiInfo.request,{requestInfo:j}},ce),[s,n]=o.useState(w.Params),r=[{title:"参数名",dataIndex:"paramName",width:150,render:(p,j,b)=>e.jsx(B,{placeholder:"参数名",value:p,onChange:C=>l(C.target.value,"paramName",b)})},{title:"类型",width:150,render:(p,j,b)=>e.jsx(B,{placeholder:"类型",value:"string",style:{color:"#1677ff",textAlign:"center",fontWeight:"bold"}})},{title:"参数值",dataIndex:"value",render:(p,j,b)=>e.jsx(B,{placeholder:"参数值",value:p,onChange:C=>l(C.target.value,"value",b)})},{title:"操作",key:"action",width:50,align:"center",className:"action",render:(p,j,b)=>e.jsx(S,{type:"text",size:"small",onClick:()=>f(!1,b),block:!0,children:e.jsx(Be,{})})}],l=(p,j,b)=>{a(ze({key:j,value:p,index:b,paramType:s}))},f=(p,j)=>{a(Le({isInsert:p,removeIndex:j,paramType:s}))},g=()=>{switch(s){case w.Params:return i.params;case w.Header:return i.headers;case w.Cookie:return i.cookie;default:return[]}},c=p=>{a(qe(p))},h=()=>s===w.Body?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"section-title",style:{marginBottom:"10px"},children:"请输入JSON格式的请求体"}),e.jsx(q,{defaultValue:i.body,height:"200px",onChange:p=>c(p),withBorder:!0})]}):e.jsx(Ae,{dataSource:g(),columns:r,rowKey:"id",pagination:!1,footer:()=>u(),bordered:!0,size:"small"}),u=()=>e.jsx("div",{className:"param-footer",children:e.jsx(S,{type:"link",size:"small",onClick:()=>f(!0,-1),block:!0,children:e.jsx(ne,{})})});return e.jsxs("div",{className:"mock-request",children:[e.jsx("div",{className:"section-title",children:"请求参数"}),e.jsx("div",{className:"req-nav",children:Mt.map(p=>e.jsx("div",{className:k("nav-item",{active:s===p.value}),onClick:()=>n(p.value),children:p.label},p.value))}),e.jsx("div",{className:"content",children:h()})]})},At=o.memo(G(Tt));const Bt=t=>{const a=M(),{responseInfo:i}=I(s=>{const n={};return t.mode==="mock"?n.responseInfo=s.mock.mockData.apiInfo.response:n.responseInfo=s.mock.runData.apiInfo.response,n});return e.jsxs("div",{className:"response-page",children:[e.jsx("div",{className:"section-title",children:"返回响应"}),e.jsx("div",{className:"content",children:e.jsx(q,{defaultValue:i.body,height:"200px",withBorder:!0,onChange:s=>t.mode==="run"&&a(W(s)),readOnly:t.mode==="mock"})})]})},zt=o.memo(G(Bt));const Lt=t=>{const{mode:a}=t,[i,s]=o.useState("https://lyyfsq.club:7000/api/v1/mock/project_id"),n=M(),{userReqInfo:r,reqParams:l,projectId:f,metaInfo:g,apiData:c}=I(m=>{let d={};return a==="mock"?(d.userReqInfo=m.mock.mockData.apiInfo.base,d.reqParams=m.mock.mockData.apiInfo.request,d.metaInfo=m.mock.mockData.meta_info,d.apiData=m.mock.mockData):(d.userReqInfo=m.mock.runData.apiInfo.base,d.reqParams=m.mock.runData.apiInfo.request,d.metaInfo=m.mock.runData.meta_info,d.apiData=m.mock.runData),{...d,projectId:m.project.projectInfo.id}});o.useEffect(()=>s(`https://lyyfsq.club:7000/api/v1/mock/${f}`),[f]);const[h,u]=o.useState({label:"GET",value:"GET"});o.useEffect(()=>{u({label:r.method,value:r.method})},[r]);const p=(m,d)=>{const v=m.target.value;n(d==="prefix"?Re(v):Fe(v))},j=m=>{u(m),n(Ve(m.value))},b=async()=>{const m={};let d={},v="";l.params.forEach(N=>m[N.paramName]=N.value),l.cookie.forEach(N=>v+=`${N.paramName}=${N.value}; `),m.Cookie=v,l.params.forEach(N=>d[N.paramName]=N.value);let $=`${r.prefix}/${r.path}`;a==="mock"&&($=`https://lyyfsq.club:7000/api/v1/mock/${f}/${r.path}`);const{data:x}=await We({url:$,method:r.method,headers:m,data:l.body});try{const N=JSON.stringify(x);n(W(N))}catch{n(W(x+""))}},C=async()=>{const m={};let d={},v="";l.params.forEach(x=>m[x.paramName]=x.value),l.cookie.forEach(x=>v+=`${x.paramName}=${x.value}; `),m.Cookie=v,l.params.forEach(x=>d[x.paramName]=x.value),(await Ke({project_id:f,url:"/"+r.path,method:r.method.toLowerCase(),apis_id:g.api_id,name:g.name,headers:JSON.stringify(m),params:JSON.stringify(d),response:y(c.apiInfo.response.body),data:c.apiInfo.response.body})).code===200&&Ue.success("创建成功")},y=m=>{let d={};try{d={example:JSON.parse(m)}}catch{d={example:{data:m}}}return JSON.stringify(d),JSON.stringify(d)};return e.jsx("div",{className:"doc-operator",children:e.jsxs(He,{methodValue:h,onOptionChange:m=>j(m),onPrefixInputChange:m=>p(m,"prefix"),onInputChange:m=>p(m,"path"),inputValue:r.path,urlPrefixValue:a==="run"?r.prefix:i,disablePrefix:a==="mock",rightWidth:a==="mock"?"250px":"150px",children:[e.jsx(S,{className:"btn",type:"primary",onClick:b,children:"发送"}),a==="mock"&&e.jsx(S,{type:"primary",style:{marginLeft:"10px"},onClick:C,children:"创建Mock"})]})})},qt=o.memo(G(Lt)),ae=t=>{const{mode:a,data:i,project_id:s}=t,{apiId:n}=I(l=>({apiId:l.rightSlice.value})),r=M();return o.useEffect(()=>{n!=="gl"&&(r(Je(a)),r(Xe(n)))},[r,n]),e.jsx("div",{children:e.jsx("div",{className:"mock-page",children:e.jsxs(ue.Provider,{value:{...t},children:[e.jsx(qt,{project_id:s,mode:{mode:a}}),e.jsx(At,{}),e.jsx(zt,{mode:{mode:a}})]})})})};const Ht=[{label:"JavaScirpt",key:"1"},{label:"Java",key:"2"},{label:"Go",key:"3"}],ra=[{label:"Native",key:"1"}],oa=[{label:"Unirest",key:"1"},{label:"OkHttp",key:"2"}],la=[{label:"fetch",key:"1"},{label:"axios",key:"2"},{label:"jquery",key:"3"},{label:"request",key:"4"},{label:"XHR",key:"5"}],Rt=()=>{const[t,a]=o.useState("1"),i=n=>{a(n.key)};let s=null;return s=t==="1"?_.lazy(()=>R(()=>import("./JSCodeContent-db219284.js"),["assets/JSCodeContent-db219284.js","assets/index-8a3e701d.js","assets/index-3b2479b7.css"])):t==="2"?_.lazy(()=>R(()=>import("./JavaCodeContent-6b87339d.js"),["assets/JavaCodeContent-6b87339d.js","assets/index-8a3e701d.js","assets/index-3b2479b7.css"])):_.lazy(()=>R(()=>import("./GoCodeContent-b5fab496.js"),["assets/GoCodeContent-b5fab496.js","assets/index-8a3e701d.js","assets/index-3b2479b7.css"])),e.jsx(_.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx("div",{className:"codeTemplate",children:e.jsxs("div",{className:"codeTemplate-body",children:[e.jsx(de,{onClick:i,style:{width:120},defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],mode:"inline",items:Ht}),e.jsx(s,{})]})})})};async function Ft(t){const a=await D.post("/v1/apis/queryversion",{apis_id:t},{});let i=[];return a.data.data.map(s=>{i.push({id:s.id,notes:s.notes})}),i}async function Vt(t){return(await D.post("/v1/apis/back",{version_id:t},{})).data.message}const Wt=t=>{let a;O();const[i,s]=o.useState([]);return o.useEffect(()=>{Ft(t.apis_id).then(n=>{a=n;let r=[];a.map(l=>{r.push({children:e.jsx("div",{className:"versionNotes",onClick:async()=>{await Vt(l.id),window.location.reload()},children:l.notes})})}),s(r)})},[t.apis_id]),e.jsx("div",{className:"versionBack",children:e.jsx(Nt,{items:i})})},Kt=_.memo(Wt),Ut=o.memo(()=>{const{message:t,modal:a}=le.useApp(),i=M(),{metaInfo:s,ownerInfo:n,folderName:r,apiId:l,baseInfo:f}=I(v=>({metaInfo:v.document.apiData.meta_info,ownerInfo:v.document.ownerUser,folderName:v.document.folderName,apiId:v.document.apiId,baseInfo:v.document.apiData.apiInfo.base}));function g(){const v=async()=>{const $=await Qe(l);$.code===200?t.success($.message):t.error($.message),i(E()),i(re(l)),i(P("gl"))};a.confirm({title:"删除接口",content:"确定要删除该接口吗？删除后不可恢复",onOk:v,onCancel:()=>{}})}L(v=>v.templateSlice.value);const[c,h]=o.useState(!1),[u,p]=o.useState(!1),j=()=>{p(!0)},b=v=>{p(!1)},C=v=>{p(!1)},y=v=>{h(!1)},m=v=>{h(!1)};function d(){h(!0)}return e.jsxs("div",{className:"intro-request",children:[e.jsx(V,{title:e.jsx("div",{children:"生成代码"}),open:c,onOk:y,onCancel:m,width:660,children:e.jsx(Rt,{})}),e.jsx(V,{title:e.jsx("div",{children:"历史版本(点击记录即回滚)"}),open:u,onOk:b,onCancel:C,children:e.jsx(Kt,{apis_id:l})}),e.jsxs("div",{className:"name-wrap",children:[e.jsx("div",{className:k("method","method-"+f.method.toLowerCase()),children:f.method}),e.jsx("div",{className:"title",children:s.name}),e.jsxs("div",{className:"opt-wrap",children:[e.jsx(S,{type:"primary",onClick:d,children:"生成代码"}),e.jsx(S,{style:{marginLeft:"10px"},onClick:j,children:"版本回滚"}),e.jsx(S,{style:{marginLeft:"10px",marginRight:"20px"},onClick:g,danger:!0,children:"删除"})]})]}),e.jsxs("div",{className:"meta-info",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"title",children:"创建时间"}),e.jsx("span",{className:"val",children:Ge(s.created)})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"title",children:"创建者"}),e.jsx("span",{className:"val",children:n.username})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"title",children:"所在目录"}),e.jsx("span",{className:"val",children:r})]})]})]})});const Jt=o.memo(()=>{const{requestInfo:t}=I(s=>({requestInfo:s.document.apiData.apiInfo.request}));function a(s){return s==="body"?e.jsx(K,{size:"small",title:s.slice(0,1).toUpperCase()+s.slice(1),style:{width:"100%"},children:e.jsxs("div",{className:"code-card-body-info",children:[e.jsx("span",{className:"body-title",children:"示例值"}),e.jsx("div",{className:"body-content",children:e.jsx(q,{height:"250px",lang:"json",readOnly:!0,withBorder:!0,defaultValue:t[s]})})]})}):e.jsx(K,{size:"small",title:s.slice(0,1).toUpperCase()+s.slice(1),style:{width:"100%"},children:t[s].map(n=>i(n))})}function i(s){return e.jsxs("div",{className:"param-kv",children:[e.jsxs("div",{className:"type",children:[e.jsx("div",{className:"param-name label",children:e.jsx(Z,{color:"cyan",children:s.paramName})}),e.jsx("div",{className:"param-type",children:s.type}),e.jsx("div",{className:"require",children:e.jsx(Z,{color:"default",children:s.required?"必选":"可选"})})]}),e.jsxs("div",{className:"example",children:[e.jsx("div",{className:"label",children:"示例值"}),e.jsx("div",{className:"val",children:e.jsx("div",{className:"example-tag",children:s.value?s.value:"无"})})]})]})}return e.jsxs("div",{className:"intro-req",children:[e.jsx("div",{className:"setction-title",children:"请求参数"}),e.jsx("div",{className:"req-content",children:Object.keys(t).map(s=>e.jsx("div",{className:"param-item",children:a(s)},s))})]})});const Xt=o.memo(()=>{const{apiData:t}=I(a=>({apiData:a.document.apiData}),ce);return e.jsxs("div",{className:"intro-response",children:[e.jsx("div",{className:"setction-title",children:"返回响应"}),e.jsx("div",{className:"content",children:e.jsx(K,{size:"small",title:"响应示例",extra:e.jsx("a",{href:"#",children:"生成代码"}),style:{width:"100%"},children:e.jsx("div",{className:"content-value",children:e.jsxs("div",{className:"code-card-body-info",children:[e.jsx("span",{className:"body-title",children:"示例值"}),e.jsx("div",{className:"body-content",children:e.jsx(q,{height:"250px",lang:"json",readOnly:!0,withBorder:!0,defaultValue:t.apiInfo.response.body})})]})})})})]})});const Gt=t=>{const a=M(),{apiId:i}=I(s=>({apiId:s.rightSlice.value}));return o.useEffect(()=>{i!=="gl"&&a(Ye(i))},[a,i]),e.jsxs("div",{className:"introduction-page",children:[e.jsx(Ut,{}),e.jsx(Jt,{}),e.jsx(Xt,{})]})},Qt=o.memo(Gt),Yt=[{label:"文档",key:"1"},{label:"修改文档",key:"2"},{label:"运行",key:"3"},{label:"Mock",key:"4"}],Zt=t=>{const{data:a,project_id:i}=t,[s,n]=o.useState("1"),r=l=>{n(l.key)};return e.jsxs("div",{className:"doc-area",children:[e.jsx(de,{onClick:r,selectedKeys:[s],mode:"horizontal",items:Yt}),e.jsx("div",{className:"panel",children:s==="1"?e.jsx(Qt,{data:a}):s==="2"?e.jsx(Ze,{data:a}):s==="3"?e.jsx(ae,{data:a,mode:"run",project_id:i}):e.jsx(ae,{data:a,mode:"mock",project_id:i})})]})};const ea=o.memo(()=>e.jsxs("div",{className:"logo-page",children:[e.jsx("div",{className:"text large-text",children:"🍻🍻"}),e.jsx("div",{className:"text",children:"ApiKnight"}),e.jsx("div",{className:"text small-text",children:["干杯！","今天有什么有趣的事情呢","轻舟已过万重山"][Math.floor(Math.random()*3)]})]})),ta=t=>{const a=L(i=>i.rightSlice.value);return e.jsxs("div",{className:"right-component-wrap",children:[a=="gl"&&e.jsx(et,{}),a==="blank"&&e.jsx(ea,{}),a!=="gl"&&a!=="blank"&&e.jsx(Zt,{data:a,project_id:t.project_id})]})};const aa=t=>{const a=L(i=>i.rightSlice.value);return e.jsxs("div",{className:k("cpn-right-page full-height"),children:[e.jsx("div",{className:k("tabs-wrap",{hidden:a==="blank"}),children:e.jsx(Et,{})}),e.jsx("div",{className:k("other-wrap"),children:e.jsx(ta,{project_id:t.project_id})})]})},sa=_.memo(aa),na=()=>{tt().start();const t=O(),{currentKey:a}=I(r=>({currentKey:r.tabSlice.currentKey})),s=T().state.project_id;function n(){t(at({item:{key:"project-summary",title:"项目概览",type:"gl"},index:0})),t(z("project-summary")),t(P("gl"))}return e.jsxs("div",{className:"project-api",children:[e.jsxs("div",{className:"project-api-left",children:[e.jsx(S,{type:"dashed",className:k("opt-item",{"opt-item-active":a==="project-summary"}),icon:e.jsx(ee,{}),onClick:n,children:"项目概览"}),e.jsx(S,{type:"dashed",className:k("opt-item",{"opt-item-active":a!=="project-summary"}),icon:e.jsx(ee,{}),onClick:n,children:"接口"}),e.jsx("div",{className:"api-dir",children:e.jsx(wt,{})})]}),e.jsx("div",{className:"project-api-right",children:e.jsx(sa,{project_id:s})})]})},ca=Object.freeze(Object.defineProperty({__proto__:null,default:na},Symbol.toStringTag,{value:"Module"}));export{oa as a,ra as b,ca as c,la as i};
