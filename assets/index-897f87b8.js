import{r,A as K,_ as U,C as se,c as k,a as ve,L as je,t as ye,g as be,m as Ne,b as Ce,u as w,d as T,n as J,j as e,e as ke,f as Se,i as E,P as ne,M as F,R as ie,S as $e,h as D,k as oe,s as P,F as Ie,l as re,I as z,B as S,o as Q,p as ce,q as I,v as _e,O as Oe,w as Y,x as we,y as O,z as Pe,D as L,E as De,G as X,H as Ee,T as Me,J as Te,N as _,K as M,Q as le,U as q,V as Ae,W as Be,X as ze,Y as Le,Z as qe,$ as V,a0 as He,a1 as Re,a2 as Fe,a3 as Ve,a4 as We,a5 as Ke,a6 as Ue,a7 as Je,a8 as Xe,a9 as R,aa as de,ab as Ge,ac as Qe,ad as W,ae as Z,af as Ye,ag as Ze,ah as et,ai as tt,aj as at}from"./index-a9d4b447.js";var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 680h-54V540H546v-92h238c8.8 0 16-7.2 16-16V168c0-8.8-7.2-16-16-16H240c-8.8 0-16 7.2-16 16v264c0 8.8 7.2 16 16 16h238v92H190v140h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8zM256 805.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zm288 0c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM288 384V216h448v168H288zm544 421.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM360 300a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"cluster",theme:"outlined"};const nt=st;var it=function(a,i){return r.createElement(K,U({},a,{ref:i,icon:nt}))};const ee=r.forwardRef(it);var ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"};const rt=ot;var ct=function(a,i){return r.createElement(K,U({},a,{ref:i,icon:rt}))};const lt=r.forwardRef(ct);var dt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};const mt=dt;var pt=function(a,i){return r.createElement(K,U({},a,{ref:i,icon:mt}))};const ht=r.forwardRef(pt);var ut=globalThis&&globalThis.__rest||function(t,a){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&a.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(i[s[n]]=t[s[n]]);return i};const ft=t=>{var{prefixCls:a,className:i,color:s="blue",dot:n,pending:o=!1,position:l,label:f,children:v}=t,c=ut(t,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:h}=r.useContext(se),u=h("timeline",a),p=k(`${u}-item`,{[`${u}-item-pending`]:o},i),y=/blue|red|green|gray/.test(s||"")?void 0:s,b=k(`${u}-item-head`,{[`${u}-item-head-custom`]:!!n,[`${u}-item-head-${s}`]:!y});return r.createElement("li",Object.assign({},c,{className:p}),f&&r.createElement("div",{className:`${u}-item-label`},f),r.createElement("div",{className:`${u}-item-tail`}),r.createElement("div",{className:b,style:{borderColor:y,color:y}},n),r.createElement("div",{className:`${u}-item-content`},v))},me=ft;var te=globalThis&&globalThis.__rest||function(t,a){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&a.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(i[s[n]]=t[s[n]]);return i};const xt=t=>{var{prefixCls:a,className:i,pending:s=!1,children:n,items:o,rootClassName:l,reverse:f=!1,direction:v,hashId:c,pendingDot:h,mode:u=""}=t,p=te(t,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const y=(x,N)=>u==="alternate"?x==="right"?`${a}-item-right`:x==="left"?`${a}-item-left`:N%2===0?`${a}-item-left`:`${a}-item-right`:u==="left"?`${a}-item-left`:u==="right"?`${a}-item-right`:x==="right"?`${a}-item-right`:"",b=ve(o||[]),C=typeof s=="boolean"?null:s;s&&b.push({pending:!!s,dot:h||r.createElement(je,null),children:C}),f&&b.reverse();const g=b.length,m=`${a}-item-last`,d=b.filter(x=>!!x).map((x,N)=>{var A;const H=N===g-2?m:"",fe=N===g-1?m:"",{className:xe}=x,ge=te(x,["className"]);return r.createElement(me,Object.assign({},ge,{className:k([xe,!f&&s?H:fe,y((A=x==null?void 0:x.position)!==null&&A!==void 0?A:"",N)]),key:(x==null?void 0:x.key)||N}))}),j=b.some(x=>!!(x!=null&&x.label)),$=k(a,{[`${a}-pending`]:!!s,[`${a}-reverse`]:!!f,[`${a}-${u}`]:!!u&&!j,[`${a}-label`]:j,[`${a}-rtl`]:v==="rtl"},i,l,c);return r.createElement("ul",Object.assign({},p,{className:$}),d)},gt=xt;function vt(t,a){return t&&Array.isArray(t)?t:ye(a).map(i=>{var s,n;return Object.assign({children:(n=(s=i==null?void 0:i.props)===null||s===void 0?void 0:s.children)!==null&&n!==void 0?n:""},i.props)})}const jt=t=>{const{componentCls:a}=t;return{[a]:Object.assign(Object.assign({},Ce(t)),{margin:0,padding:0,listStyle:"none",[`${a}-item`]:{position:"relative",margin:0,paddingBottom:t.itemPaddingBottom,fontSize:t.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:t.itemHeadSize,insetInlineStart:(t.itemHeadSize-t.tailWidth)/2,height:`calc(100% - ${t.itemHeadSize}px)`,borderInlineStart:`${t.tailWidth}px ${t.lineType} ${t.tailColor}`},"&-pending":{[`${a}-item-head`]:{fontSize:t.fontSizeSM,backgroundColor:"transparent"},[`${a}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:t.itemHeadSize,height:t.itemHeadSize,backgroundColor:t.dotBg,border:`${t.dotBorderWidth}px ${t.lineType} transparent`,borderRadius:"50%","&-blue":{color:t.colorPrimary,borderColor:t.colorPrimary},"&-red":{color:t.colorError,borderColor:t.colorError},"&-green":{color:t.colorSuccess,borderColor:t.colorSuccess},"&-gray":{color:t.colorTextDisabled,borderColor:t.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:t.itemHeadSize/2,insetInlineStart:t.itemHeadSize/2,width:"auto",height:"auto",marginBlockStart:0,paddingBlock:t.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:-(t.fontSize*t.lineHeight-t.fontSize)+t.lineWidth,marginInlineStart:t.margin+t.itemHeadSize,marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${a}-item-tail`]:{display:"none"},[`> ${a}-item-content`]:{minHeight:t.controlHeightLG*1.2}}},[`&${a}-alternate,
        &${a}-right,
        &${a}-label`]:{[`${a}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:`-${t.marginXXS}px`,"&-custom":{marginInlineStart:t.tailWidth/2}},"&-left":{[`${a}-item-content`]:{insetInlineStart:`calc(50% - ${t.marginXXS}px)`,width:`calc(50% - ${t.marginSM}px)`,textAlign:"start"}},"&-right":{[`${a}-item-content`]:{width:`calc(50% - ${t.marginSM}px)`,margin:0,textAlign:"end"}}}},[`&${a}-right`]:{[`${a}-item-right`]:{[`${a}-item-tail,
            ${a}-item-head,
            ${a}-item-head-custom`]:{insetInlineStart:`calc(100% - ${(t.itemHeadSize+t.tailWidth)/2}px)`},[`${a}-item-content`]:{width:`calc(100% - ${t.itemHeadSize+t.marginXS}px)`}}},[`&${a}-pending
        ${a}-item-last
        ${a}-item-tail`]:{display:"block",height:`calc(100% - ${t.margin}px)`,borderInlineStart:`${t.tailWidth}px dotted ${t.tailColor}`},[`&${a}-reverse
        ${a}-item-last
        ${a}-item-tail`]:{display:"none"},[`&${a}-reverse ${a}-item-pending`]:{[`${a}-item-tail`]:{insetBlockStart:t.margin,display:"block",height:`calc(100% - ${t.margin}px)`,borderInlineStart:`${t.tailWidth}px dotted ${t.tailColor}`},[`${a}-item-content`]:{minHeight:t.controlHeightLG*1.2}},[`&${a}-label`]:{[`${a}-item-label`]:{position:"absolute",insetBlockStart:-(t.fontSize*t.lineHeight-t.fontSize)+t.tailWidth,width:`calc(50% - ${t.marginSM}px)`,textAlign:"end"},[`${a}-item-right`]:{[`${a}-item-label`]:{insetInlineStart:`calc(50% + ${t.marginSM}px)`,width:`calc(50% - ${t.marginSM}px)`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${a}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},yt=be("Timeline",t=>{const a=Ne(t,{itemHeadSize:10,customHeadPaddingVertical:t.paddingXXS,paddingInlineEnd:2});return[jt(a)]},t=>({tailColor:t.colorSplit,tailWidth:t.lineWidthBold,dotBorderWidth:t.wireframe?t.lineWidthBold:t.lineWidth*3,dotBg:t.colorBgContainer,itemPaddingBottom:t.padding*1.25}));var bt=globalThis&&globalThis.__rest||function(t,a){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&a.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(i[s[n]]=t[s[n]]);return i};const pe=t=>{const{getPrefixCls:a,direction:i,timeline:s}=r.useContext(se),{prefixCls:n,children:o,items:l,className:f,style:v}=t,c=bt(t,["prefixCls","children","items","className","style"]),h=a("timeline",n),[u,p]=yt(h),y=vt(l,o);return u(r.createElement(gt,Object.assign({},c,{className:k(s==null?void 0:s.className,f),style:Object.assign(Object.assign({},s==null?void 0:s.style),v),prefixCls:h,direction:i,items:y,hashId:p})))};pe.Item=me;const Nt=pe;function Ct(t){const a={},i={};return t.forEach(s=>{i[s.key]={key:s.key,title:s.title,type:s.type,children:[]}}),t.forEach(s=>{const n=s.pid,o=s.key;n===null?a[o]=i[o]:i[n].children.push(i[o])}),Object.values(a)}const kt=t=>{const a=w(),{data:i}=t,n=T().state.project_id,[o,l]=J.useNotification();return e.jsxs("span",{style:{display:"inline"},onClick:()=>{ke(n,i.key,Se()).then(f=>{a(E())})},children:[e.jsx(ne,{}),l]})},St=t=>{const i=T().state.project_id,s=w(),{data:n}=t,o=r.createContext(null),[l,f]=r.useState(!1),[v,c]=r.useState(!1),[h,u]=r.useState(!1),[p,y]=r.useState("确定要删除该节点吗？该操作不可逆!"),[b,C]=J.useNotification(),g=()=>{c(!0)},m=n.type=="FILE"?{project_id:i,folder_id:n.key}:{apis_id:n.key},d=()=>{y("节点正在删除中"),u(!0),c(!1),u(!1);const x=n.type==="FILE"?"/v1/folder/delete":"/v1/apis/delete";f(!0),D.post(x,m,{}).then(N=>{N.data.code==200?(f(!0),s(E()),n.type!=="FILE"&&s(oe(n.key))):((H=>{b.info({message:"错误提示",description:N.data.message,placement:H})})("topRight"),setTimeout(()=>{c(!1)},1500))}),s(P("gl"))},j=x=>{c(!1),x.stopPropagation()};function $(){g()}return e.jsxs("span",{style:{display:"inline"},onClick:$,children:[e.jsx(lt,{}),e.jsx(F,{title:"删除该节点",open:v,onOk:d,confirmLoading:h,onCancel:j,children:e.jsx("div",{children:e.jsx(o.Consumer,{children:()=>p})})}),ie.createPortal(e.jsx("div",{children:l&&e.jsxs($e,{tip:"Loading",size:"large",children:[e.jsx("div",{className:"content"}),C]})}),document.body)]})};const he=t=>e.jsx("div",{children:t.value!=="FILE"?e.jsx("div",{className:`color-${t.value}`,children:e.jsx("div",{className:"ant-select-selection-item",children:t.value==="gl"?"":t.value})}):e.jsx("div",{children:e.jsx(Ie,{})})});const $t=t=>{const[a,i]=J.useNotification(),s=w(),[n,o]=r.useState("");function l(h){h.stopPropagation(),o(h.target.value)}function f(){t.handleClick(!1),s(Q())}function v(h){(p=>{a.info({message:"错误提示",description:h,placement:p})})("topRight")}function c(h){h.stopPropagation(),t.title==="添加子目录"?D.post("/v1/folder/create",{project_id:t.data.project_id,parent_id:t.data.parent_id,name:n},{}).then(u=>{u.data.code==200?s(E()):v(u.data.message)}):D.post("/v1/folder/update",{folder_id:t.data.parent_id,parent_id:t.data.pid,name:n},{}).then(u=>{u.data.code==200?s(E()):alert(u.data.message)}),s(Q()),t.handleClick(!1)}return ie.createPortal(e.jsxs("div",{className:"createFile",onClick:h=>{h.stopPropagation()},children:[i,e.jsxs("div",{className:"createFile-title",children:[e.jsx("span",{children:e.jsx("h3",{children:t.title})}),e.jsx("span",{className:"createFile-title__icon",onClick:f,children:e.jsx(re,{})})]}),e.jsx("div",{className:"createFile-content",children:e.jsx(z,{placeholder:"请输入要创建的文件夹名字",value:n,onChange:l})}),e.jsx("div",{className:"createFile-btn",children:e.jsx(S,{size:"large",onClick:c,children:"创建"})})]}),document.body)};const It=t=>{const{data:a}=t,{modal:i}=ce.useApp(),s=w(),{prijectInfo:n}=I(d=>({prijectInfo:d.project.projectInfo}));function o(d){s(Y()),p(!0),d.stopPropagation(),m("添加子目录")}function l(d){s(Y()),p(!0),d.stopPropagation(),m("修改文件夹名称")}r.useEffect(()=>{b({project_id:h,parent_id:a.key,pid:a.pid})},[]);async function f(){p(!1);const d=await we(n.api_list,n.id);navigator.clipboard.writeText(d),i.success({title:"分享成功",content:e.jsxs("div",{children:[e.jsx("p",{children:"分享链接已经复制到剪切板"}),e.jsx("p",{style:{color:"#1677ff"},children:d})]})})}const v=e.jsxs("div",{children:[e.jsx("div",{children:a.type==="FILE"?e.jsxs("div",{children:[e.jsx(S,{block:!0,onClick:o,children:"添加子目录"}),e.jsx(S,{block:!0,onClick:l,children:"更改文件夹名"})]}):e.jsx("div",{style:{display:"none"}})}),e.jsx("div",{children:e.jsx(S,{block:!0,onClick:f,children:"导出"})})]}),h=T().state.project_id,[u,p]=r.useState(!1),[y,b]=r.useState({project_id:h,parent_id:a.key,pid:a.pid}),C=d=>{p(d)},[g,m]=r.useState("添加子目录");return e.jsxs("span",{children:[e.jsx(_e,{content:v,title:"",trigger:"click",children:e.jsx(ht,{})}),u&&e.jsx($t,{handleClick:C,data:y,title:g}),u&&e.jsx(Oe,{data:1e4})]})},_t=t=>{const[a,i]=r.useState(!1);function s(h){i(!a),h.stopPropagation()}const n=t.data.title,o={key:n.key,pid:n.pid,type:n.type},l={key:n.key,pid:n.pid,type:n.type},f={key:n.key,type:n.type},v=w();function c(){if(n.type!=="FILE"){const h={key:n.key,title:n.title,type:n.type};v(Pe(h)),v(P(n.key)),v(L(n.key))}}return e.jsxs("div",{className:"InterfaceBlock",onMouseEnter:s,onMouseLeave:s,onDoubleClick:c,children:[e.jsx("div",{className:"interface-type",children:e.jsx(he,{value:n.type})}),e.jsx("div",{className:"InterfaceBlock-title",children:String(n.title)}),e.jsxs("div",{className:"btn",children:[a&&e.jsxs("div",{style:{display:"flex"},children:[n.pid!==null&&e.jsx(St,{data:f}),n.type==="FILE"&&e.jsx("div",{children:e.jsx(kt,{data:o})})]}),e.jsx(It,{data:l})]})]})},Ot=O.memo(_t);function B(t,a,i){const s=t.filter(c=>c.project_id===i),n=a.filter(c=>c.project_id===i);s.map(c=>{c.type="FILE"}),n.map(c=>{try{const h=De(c.request_data);c.type=h.getMethod()}catch{}}),n.map(c=>{c.parent_id=c.folder_id});const o=[...n,...s],l=[];o.map(c=>{const h={key:c.id,title:c.name,pid:c.parent_id,type:c.type};l.push(h)});const f=l;return f.map(c=>{c.title={key:c.key,title:c.title,pid:c.pid,type:c.type}}),f}const wt=()=>{const[t,a]=r.useState(!1),i=[{id:"694948f6-7908-4388-8da7-c744b13f76b6",project_id:1063,name:"根目录",parent_id:null}],[s,n]=r.useState(B(i,[],1063)),[o,l]=r.useState({value:s}),v=T().state.project_id;function c(){a(!0),D.post("/v1/project/query",{projectid:v},{}).then(g=>{g.data.code==200&&(n(B(g.data.data.folder_list,g.data.data.api_list,v)),l({value:B(g.data.data.folder_list,g.data.data.api_list,v)}),g.data.data.folder_list,g.data.data.api_list,B(g.data.data.folder_list,g.data.data.api_list,v),a(!1))})}const h=X(g=>g.watchDir.value);r.useEffect(()=>{c()},[h]);function u(g){const m=[];for(const d of g){const j={key:d.key,title:e.jsx(Ot,{data:{title:d.title,key:d.key,pid:d.pid,type:d.type}}),type:d.type,pid:d.pid};m.push(j)}return m}const p=w(),y=g=>{if(g.node.type==="FILE"){const m=g.dragNode.type==="FILE"?"/v1/folder/update":"/v1/apis/update",d=g.dragNode.type==="FILE"?{folder_id:g.dragNodesKeys[0],parent_id:g.node.key}:{apis_id:g.dragNodesKeys[0],folder_id:g.node.key};a(!0),D.post(m,d,{}).then(j=>{p(E()),a(!0)})}},b=u(o.value),C=Ct(b);return e.jsx("div",{className:"tree-part",children:(()=>t?e.jsx("div",{className:"loading",children:e.jsx(Ee,{style:{height:"100%"}})}):e.jsx(Me,{treeData:C,defaultExpandAll:!0,draggable:!0,blockNode:!0,onDrop:y,style:{width:"250px"},className:"renderTree"}))()})};const Pt=t=>{const{active:a,onRemoveTab:i,onSelected:s,index:n}=t,[o,l]=r.useState(!1);function f(){l(!o)}function v(c){c.stopPropagation(),i==null||i(n)}return e.jsxs("div",{className:k("tab",{"tab-active":a}),onMouseEnter:f,onMouseLeave:f,onClick:c=>s(n),children:[e.jsx("div",{className:"tab-title",children:e.jsx("span",{style:{marginRight:"7px"},children:e.jsx(he,{value:t.data.type})})}),e.jsx("div",{className:"tab-content",children:e.jsx("span",{children:t.data.title})}),e.jsx("div",{className:"tab-closed",children:o&&e.jsx(re,{onClick:v})})]})};const Dt=()=>{const t=w(),{tabs:a,currentKey:i}=I(o=>({tabs:o.tabSlice.data,currentKey:o.tabSlice.currentKey}));r.useEffect(()=>{const o=a.find(l=>l.key===i);o.type==="gl"?t(P("gl")):t(P(o.key))},[i]),r.useEffect(()=>{a.length===0&&t(P("blank"))},[a]);function s(o){let l=0;a.length>1&&(l=o===0?1:o-1),t(L(a[l].key)),t(Te(o))}function n(o){t(L(a[o].key))}return e.jsx("div",{className:"tabs",children:a.map((o,l)=>e.jsx(Pt,{data:o,active:o.key===i,onRemoveTab:s,onSelected:n,index:l},o.key))})},Et=O.memo(Dt);const ue=O.createContext({mode:"run"});function G(t){return function(a){return e.jsx(ue.Consumer,{children:i=>e.jsx(t,{...a,...i})})}}const Mt=[{label:"Params",value:_.Params},{label:"Body",value:_.Body},{label:"Cookie",value:_.Cookie},{label:"Header",value:_.Header}],Tt=t=>{const a=M(),{requestInfo:i}=I(p=>{let y={};return t.mode==="mock"?y=p.mock.mockData.apiInfo.request:y=p.mock.runData.apiInfo.request,{requestInfo:y}},le),[s,n]=r.useState(_.Params),o=[{title:"参数名",dataIndex:"paramName",width:150,render:(p,y,b)=>e.jsx(z,{placeholder:"参数名",value:p,onChange:C=>l(C.target.value,"paramName",b)})},{title:"类型",width:150,render:(p,y,b)=>e.jsx(z,{placeholder:"类型",value:"string",style:{color:"#1677ff",textAlign:"center",fontWeight:"bold"}})},{title:"参数值",dataIndex:"value",render:(p,y,b)=>e.jsx(z,{placeholder:"参数值",value:p,onChange:C=>l(C.target.value,"value",b)})},{title:"操作",key:"action",width:50,align:"center",className:"action",render:(p,y,b)=>e.jsx(S,{type:"text",size:"small",onClick:()=>f(!1,b),block:!0,children:e.jsx(Be,{})})}],l=(p,y,b)=>{a(ze({key:y,value:p,index:b,paramType:s}))},f=(p,y)=>{a(Le({isInsert:p,removeIndex:y,paramType:s}))},v=()=>{switch(s){case _.Params:return i.params;case _.Header:return i.headers;case _.Cookie:return i.cookie;default:return[]}},c=p=>{a(qe(p))},h=()=>s===_.Body?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"section-title",style:{marginBottom:"10px"},children:"请输入JSON格式的请求体"}),e.jsx(q,{defaultValue:i.body,height:"200px",onChange:p=>c(p),withBorder:!0})]}):e.jsx(Ae,{dataSource:v(),columns:o,rowKey:"id",pagination:!1,footer:()=>u(),bordered:!0,size:"small"}),u=()=>e.jsx("div",{className:"param-footer",children:e.jsx(S,{type:"link",size:"small",onClick:()=>f(!0,-1),block:!0,children:e.jsx(ne,{})})});return e.jsxs("div",{className:"mock-request",children:[e.jsx("div",{className:"section-title",children:"请求参数"}),e.jsx("div",{className:"req-nav",children:Mt.map(p=>e.jsx("div",{className:k("nav-item",{active:s===p.value}),onClick:()=>n(p.value),children:p.label},p.value))}),e.jsx("div",{className:"content",children:h()})]})},At=r.memo(G(Tt));const Bt=t=>{const a=M(),{responseInfo:i}=I(s=>{const n={};return t.mode==="mock"?n.responseInfo=s.mock.mockData.apiInfo.response:n.responseInfo=s.mock.runData.apiInfo.response,n});return e.jsxs("div",{className:"response-page",children:[e.jsx("div",{className:"section-title",children:"返回响应"}),e.jsx("div",{className:"content",children:e.jsx(q,{defaultValue:i.body,height:"200px",withBorder:!0,onChange:s=>t.mode==="run"&&a(V(s)),readOnly:t.mode==="mock"})})]})},zt=r.memo(G(Bt));const Lt=t=>{const{mode:a}=t,[i,s]=r.useState("https://lyyfsq.club:7000/api/v1/mock/project_id"),n=M(),{userReqInfo:o,reqParams:l,projectId:f,metaInfo:v,apiData:c}=I(m=>{const d={};return a==="mock"?(d.userReqInfo=m.mock.mockData.apiInfo.base,d.reqParams=m.mock.mockData.apiInfo.request,d.metaInfo=m.mock.mockData.meta_info,d.apiData=m.mock.mockData):(d.userReqInfo=m.mock.runData.apiInfo.base,d.reqParams=m.mock.runData.apiInfo.request,d.metaInfo=m.mock.runData.meta_info,d.apiData=m.mock.runData),{...d,projectId:m.project.projectInfo.id}});r.useEffect(()=>s(`https://lyyfsq.club:7000/api/v1/mock/${f}`),[f]);const[h,u]=r.useState({label:"GET",value:"GET"});r.useEffect(()=>{u({label:o.method,value:o.method})},[o]);const p=(m,d)=>{const j=m.target.value;n(d==="prefix"?Re(j):Fe(j))},y=m=>{u(m),n(Ve(m.value))},b=async()=>{const m={},d={};let j="";l.params.forEach(N=>m[N.paramName]=N.value),l.cookie.forEach(N=>j+=`${N.paramName}=${N.value}; `),m.Cookie=j,l.params.forEach(N=>d[N.paramName]=N.value);let $=`${o.prefix}/${o.path}`;a==="mock"&&($=`https://lyyfsq.club:7000/api/v1/mock/${f}/${o.path}`);const{data:x}=await We({url:$,method:o.method,headers:m,data:l.body});try{const N=JSON.stringify(x);n(V(N))}catch{n(V(x+""))}},C=async()=>{const m={},d={};let j="";l.params.forEach(x=>m[x.paramName]=x.value),l.cookie.forEach(x=>j+=`${x.paramName}=${x.value}; `),m.Cookie=j,l.params.forEach(x=>d[x.paramName]=x.value),(await Ke({project_id:f,url:"/"+o.path,method:o.method.toLowerCase(),apis_id:v.api_id,name:v.name,headers:JSON.stringify(m),params:JSON.stringify(d),response:g(c.apiInfo.response.body),data:c.apiInfo.response.body})).code===200&&Ue.success("创建成功")},g=m=>{let d={};try{d={example:JSON.parse(m)}}catch{d={example:{data:m}}}return JSON.stringify(d),JSON.stringify(d)};return e.jsx("div",{className:"doc-operator",children:e.jsxs(He,{methodValue:h,onOptionChange:m=>y(m),onPrefixInputChange:m=>p(m,"prefix"),onInputChange:m=>p(m,"path"),inputValue:o.path,urlPrefixValue:a==="run"?o.prefix:i,disablePrefix:a==="mock",rightWidth:a==="mock"?"250px":"150px",children:[e.jsx(S,{className:"btn",type:"primary",onClick:b,children:"发送"}),a==="mock"&&e.jsx(S,{type:"primary",style:{marginLeft:"10px"},onClick:C,children:"创建Mock"})]})})},qt=r.memo(G(Lt)),ae=t=>{const{mode:a,project_id:i}=t,{apiId:s}=I(o=>({apiId:o.rightSlice.value})),n=M();return r.useEffect(()=>{s!=="gl"&&(n(Je(a)),n(Xe(s)))},[n,s]),e.jsx("div",{children:e.jsx("div",{className:"mock-page",children:e.jsxs(ue.Provider,{value:{...t},children:[e.jsx(qt,{mode:a}),e.jsx(At,{mode:"run"}),e.jsx(zt,{mode:a})]})})})};const Ht=[{label:"JavaScirpt",key:"1"},{label:"Java",key:"2"},{label:"Go",key:"3"}],oa=[{label:"Native",key:"1"}],ra=[{label:"Unirest",key:"1"},{label:"OkHttp",key:"2"}],ca=[{label:"fetch",key:"1"},{label:"axios",key:"2"},{label:"jquery",key:"3"},{label:"request",key:"4"},{label:"XHR",key:"5"}],Rt=()=>{const[t,a]=r.useState("1"),i=n=>{a(n.key)};let s=null;return s=t==="1"?O.lazy(()=>R(()=>import("./JSCodeContent-13ecd5a1.js"),["assets/JSCodeContent-13ecd5a1.js","assets/index-a9d4b447.js","assets/index-76b74f02.css"])):t==="2"?O.lazy(()=>R(()=>import("./JavaCodeContent-abd971c9.js"),["assets/JavaCodeContent-abd971c9.js","assets/index-a9d4b447.js","assets/index-76b74f02.css"])):O.lazy(()=>R(()=>import("./GoCodeContent-4af70a53.js"),["assets/GoCodeContent-4af70a53.js","assets/index-a9d4b447.js","assets/index-76b74f02.css"])),e.jsx(O.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx("div",{className:"codeTemplate",children:e.jsxs("div",{className:"codeTemplate-body",children:[e.jsx(de,{onClick:i,style:{width:120},defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],mode:"inline",items:Ht}),e.jsx(s,{})]})})})};async function Ft(t){const a=await D.post("/v1/apis/queryversion",{apis_id:t},{}),i=[];return a.data.data.map(s=>{i.push({id:s.id,notes:s.notes})}),i}async function Vt(t){return(await D.post("/v1/apis/back",{version_id:t},{})).data.message}const Wt=t=>{let a;const[i,s]=r.useState([]);return r.useEffect(()=>{Ft(t.apis_id).then(n=>{a=n;const o=[];a.map(l=>{o.push({children:e.jsx("div",{className:"versionNotes",onClick:async()=>{await Vt(l.id),window.location.reload()},children:l.notes})})}),s(o)})},[t.apis_id]),e.jsx("div",{className:"versionBack",children:e.jsx(Nt,{items:i})})},Kt=O.memo(Wt),Ut=r.memo(()=>{const{message:t,modal:a}=ce.useApp(),i=M(),{metaInfo:s,ownerInfo:n,folderName:o,apiId:l,baseInfo:f}=I(j=>({metaInfo:j.document.apiData.meta_info,ownerInfo:j.document.ownerUser,folderName:j.document.folderName,apiId:j.document.apiId,baseInfo:j.document.apiData.apiInfo.base}));function v(){const j=async()=>{const $=await Qe(l);$.code===200?t.success($.message):t.error($.message),i(E()),i(oe(l)),i(P("gl"))};a.confirm({title:"删除接口",content:"确定要删除该接口吗？删除后不可恢复",onOk:j,onCancel:()=>{}})}const[c,h]=r.useState(!1),[u,p]=r.useState(!1),y=()=>{p(!0)},b=j=>{p(!1)},C=j=>{p(!1)},g=j=>{h(!1)},m=j=>{h(!1)};function d(){h(!0)}return e.jsxs("div",{className:"intro-request",children:[e.jsx(F,{title:e.jsx("div",{children:"生成代码"}),open:c,onOk:g,onCancel:m,width:660,children:e.jsx(Rt,{})}),e.jsx(F,{title:e.jsx("div",{children:"历史版本(点击记录即回滚)"}),open:u,onOk:b,onCancel:C,children:e.jsx(Kt,{apis_id:l})}),e.jsxs("div",{className:"name-wrap",children:[e.jsx("div",{className:k("method","method-"+f.method.toLowerCase()),children:f.method}),e.jsx("div",{className:"title",children:s.name}),e.jsxs("div",{className:"opt-wrap",children:[e.jsx(S,{type:"primary",onClick:d,children:"生成代码"}),e.jsx(S,{style:{marginLeft:"10px"},onClick:y,children:"版本回滚"}),e.jsx(S,{style:{marginLeft:"10px",marginRight:"20px"},onClick:v,danger:!0,children:"删除"})]})]}),e.jsxs("div",{className:"meta-info",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"title",children:"创建时间"}),e.jsx("span",{className:"val",children:Ge(s.created)})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"title",children:"创建者"}),e.jsx("span",{className:"val",children:n.username})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"title",children:"所在目录"}),e.jsx("span",{className:"val",children:o})]})]})]})});const Jt=r.memo(()=>{const{requestInfo:t}=I(s=>({requestInfo:s.document.apiData.apiInfo.request}));function a(s){return s==="body"?e.jsx(W,{size:"small",title:s.slice(0,1).toUpperCase()+s.slice(1),style:{width:"100%"},children:e.jsxs("div",{className:"code-card-body-info",children:[e.jsx("span",{className:"body-title",children:"示例值"}),e.jsx("div",{className:"body-content",children:e.jsx(q,{height:"250px",lang:"json",readOnly:!0,withBorder:!0,defaultValue:t[s]})})]})}):e.jsx(W,{size:"small",title:s.slice(0,1).toUpperCase()+s.slice(1),style:{width:"100%"},children:t[s].map(n=>i(n))})}function i(s){return e.jsxs("div",{className:"param-kv",children:[e.jsxs("div",{className:"type",children:[e.jsx("div",{className:"param-name label",children:e.jsx(Z,{color:"cyan",children:s.paramName})}),e.jsx("div",{className:"param-type",children:s.type}),e.jsx("div",{className:"require",children:e.jsx(Z,{color:"default",children:s.required?"必选":"可选"})})]}),e.jsxs("div",{className:"example",children:[e.jsx("div",{className:"label",children:"示例值"}),e.jsx("div",{className:"val",children:e.jsx("div",{className:"example-tag",children:s.value?s.value:"无"})})]})]},s.id)}return e.jsxs("div",{className:"intro-req",children:[e.jsx("div",{className:"setction-title",children:"请求参数"}),e.jsx("div",{className:"req-content",children:Object.keys(t).map(s=>e.jsx("div",{className:"param-item",children:a(s)},s))})]})});const Xt=r.memo(()=>{const{apiData:t}=I(a=>({apiData:a.document.apiData}),le);return t.apiInfo.response.body,e.jsxs("div",{className:"intro-response",children:[e.jsx("div",{className:"setction-title",children:"返回响应"}),e.jsx("div",{className:"content",children:e.jsx(W,{size:"small",title:"响应示例",extra:e.jsx("a",{href:"#",children:"生成代码"}),style:{width:"100%"},children:e.jsx("div",{className:"content-value",children:e.jsxs("div",{className:"code-card-body-info",children:[e.jsx("span",{className:"body-title",children:"示例值"}),e.jsx("div",{className:"body-content",children:e.jsx(q,{height:"250px",lang:"json",readOnly:!0,withBorder:!0,defaultValue:t.apiInfo.response.body})})]})})})})]})});const Gt=t=>{const a=M(),{apiId:i}=I(s=>({apiId:s.rightSlice.value}));return r.useEffect(()=>{i!=="gl"&&a(Ye(i))},[a,i]),e.jsxs("div",{className:"introduction-page",children:[e.jsx(Ut,{}),e.jsx(Jt,{}),e.jsx(Xt,{})]})},Qt=r.memo(Gt),Yt=[{label:"文档",key:"1"},{label:"修改文档",key:"2"},{label:"运行",key:"3"},{label:"Mock",key:"4"}],Zt=t=>{const{data:a,project_id:i}=t,[s,n]=r.useState("1"),o=l=>{n(l.key)};return e.jsxs("div",{className:"doc-area",children:[e.jsx(de,{onClick:o,selectedKeys:[s],mode:"horizontal",items:Yt}),e.jsx("div",{className:"panel",children:s==="1"?e.jsx(Qt,{data:a}):s==="2"?e.jsx(Ze,{data:a}):s==="3"?e.jsx(ae,{mode:"run",project_id:i}):e.jsx(ae,{mode:"mock",project_id:i})})]})};const ea=r.memo(()=>e.jsxs("div",{className:"logo-page",children:[e.jsx("div",{className:"text large-text",children:"🍻🍻"}),e.jsx("div",{className:"text",children:"ApiKnight"}),e.jsx("div",{className:"text small-text",children:["干杯！","今天有什么有趣的事情呢","轻舟已过万重山"][Math.floor(Math.random()*3)]})]})),ta=t=>{const a=X(i=>i.rightSlice.value);return e.jsxs("div",{className:"right-component-wrap",children:[a=="gl"&&e.jsx(et,{}),a==="blank"&&e.jsx(ea,{}),a!=="gl"&&a!=="blank"&&e.jsx(Zt,{data:a,project_id:t.project_id})]})};const aa=t=>{const a=X(i=>i.rightSlice.value);return e.jsxs("div",{className:k("cpn-right-page full-height"),children:[e.jsx("div",{className:k("tabs-wrap",{hidden:a==="blank"}),children:e.jsx(Et,{})}),e.jsx("div",{className:k("other-wrap"),children:e.jsx(ta,{project_id:t.project_id})})]})},sa=O.memo(aa),na=()=>{tt().start();const t=w(),{currentKey:a}=I(o=>({currentKey:o.tabSlice.currentKey})),s=T().state.project_id;function n(){t(at({item:{key:"project-summary",title:"项目概览",type:"gl"},index:0})),t(L("project-summary")),t(P("gl"))}return e.jsxs("div",{className:"project-api",children:[e.jsxs("div",{className:"project-api-left",children:[e.jsx(S,{type:"dashed",className:k("opt-item",{"opt-item-active":a==="project-summary"}),icon:e.jsx(ee,{}),onClick:n,children:"项目概览"}),e.jsx(S,{type:"dashed",className:k("opt-item",{"opt-item-active":a!=="project-summary"}),icon:e.jsx(ee,{}),onClick:n,children:"接口"}),e.jsx("div",{className:"api-dir",children:e.jsx(wt,{})})]}),e.jsx("div",{className:"project-api-right",children:e.jsx(sa,{project_id:s})})]})},la=Object.freeze(Object.defineProperty({__proto__:null,default:na},Symbol.toStringTag,{value:"Module"}));export{ra as a,oa as b,la as c,ca as i};
